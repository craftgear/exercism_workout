<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>お気楽 Perl/Tk プログラミング入門</title>
  <meta name="description" content="Perl/Tk,Perl/Tk入門,GUI,プログラミング">
  <link rel="stylesheet" type="text/css" href="../home_styles.css">
</head>
<body><!-- geoguide start --><div align=center><script language="javascript">var jps=382116062;var jpt=1550881765</script><script language="javascript" src="http://bc-geocities.yahoo.co.jp/js/gg.js"></script></div><!-- geoguide end -->
M.Hiroi's Home Page
<div class="small">
http://www.geocities.jp/m_hiroi/
</div>
<div class="ce">
<h1>Perl/Tk memo</h1>
<h2>お気楽 Perl/Tk プログラミング入門</h2>
<div class="small">
[ <a href="perltk02.html">PrevPage</a> | <a href="index.html">Perl/Tk</a> | <a href="perltk04.html">NextPage</a> ]
<hr>
</div>
</div>
<section class="contents">
<h3 id="chapter7">リストボックスとスクロールバー</h3>
<p> 次は、リストボックスとスクロールバーというウィジェットを説明します。リストボックスは複数の文字列を表示し、ユーザーはその中からひとつ以上の文字列を選ぶことができます。スクロールバーは、ほかのウィジェットの表示範囲を制御します。例題として、calc.pl で入力した計算式をリストボックスに格納しておいて、必要なときに取り出せるように改造してみましょう。
</p>

<h4>●リストボックス</h4>
<p> 最初にリストボックスから説明します。リストボックスはメソッド Listbox で作成します。Listbox で指定する主なオプションは、表示範囲のコントロールと選択方法です。
</p>
<table border=1>
<caption>表：Listbox の主なオプション</caption>
<tbody>
  <tr><td>-xscrollcommand</td><td>x 方向のスクロールメソッドを指定</td></tr>
  <tr><td>-yscrollcommand</td><td>y 方向のスクロールメソッドを指定</td></tr>
  <tr><td>-selectmode</td><td>セレクションモード</td></tr>
</tbody>
</table>

<p> -xscrollcommand/-yscrollcommand には、スクロールバーウィジェットのメソッド set を指定します。リストボックスの表示範囲が変更されたときに、指定したメソッド set が呼び出されます。これはコマンド scrollbar と一緒に説明します。セレクションには次のモードが用意されています。
</p>
<ul>
  <li><b>single</b><br>
ひとつの行をマウスの左クリックで選択する。
  <li><b>browse</b><br>
single と同じだが、ドラッグによって選択される行が変化し、ボタンを離したところの行が選択される。
  <li><b>multiple</b><br>
左クリックで複数行を選択する（ドラッグは不可）。
  <li><b>extended</b><br>
ドラッグで複数行を選択するが、左クリックではいままで選択した行はキャンセルされ、クリックした行のみ選択される。CTRL キーを押しながら左クリックするとトグル動作（結果が反転）となり、シフトキーを押しながら左クリックすると直前に左クリックした行から現在の行までが選択される。
</ul>
<p> -selectmode のデフォルト値は browse です。データの挿入、削除、取得は次のメソッドで行います。
</p>
<ul>
  <li><b>insert( index, element, ...)</b><br> 指定した位置の直前に文字列を挿入
  <li><b>delete( first, last )</b><br> 指定した範囲の行を削除する
  <li><b>get( first, last )</b><br> 指定した範囲の行をひとつの文字列として返す
  <li><b>index( index )</b><br> 指定した位置の行番号を返す
  <li><b>curselection</b><br> 選択された行番号をリストにして返す
  <li><b>see( index )</b><br> 指定した位置が見えるようにスクロールする
</ul>

<p> このほかにもいろいろなメソッドがありますが、とくにスクロールバーに関係する xview/yview メソッドが重要です。これは、Scrollbar メソッドのところで説明します。<p>  位置の指定には次の方法があります。
</p>
<ul>
  <li><b>n (数値)</b><br>n 行目      
  <li><b>active</b><br>左ボタンを離したときの行
  <li><b>anchor</b><br>左ボタンを押したときの行
  <li><b>end</b><br>
最後の行、ただし、insert で指定すると最終行の次にデータが追加される。
  <li><b>@x,y</b><br>指定した座標に最も近い行
</ul>
<p> セレクションモードが extended のときにドラッグで選択した場合、最初の行が anchor で最後の行が active となります。したがって、delete に anchor と active を指定すると、選択した行をリストボックスから削除することになります。
</p>
<h4>●スクロールバー</h4>
<p> 次はスクロールバーを説明します。スクロールバーは、その両端に矢印がつき、中央付近には四角いスライダが表示されます。矢印を左クリックするか、スライダをドラッグすることで表示位置を変更します。また、矢印とスライダの隙間をクリックすると 1 画面分スクロールします。スクロールバーを作るメソッドは Scrollbar です。Scrollbar で主に使用されるオプションには次のものがあります。
</p>

<table border=1>
<caption>表：Scrollbar の主なオプション</caption>
<tbody>
  <tr><td>-orient</td><td>スクロールバーの方向</td></tr>
  <tr><td>-troughcolor</td><td>矢印とスクロールの隙間の色</td></tr>
  <tr><td>-command</td><td>スクロールバーが動いたときに実行するメソッド</td></tr>
</tbody>
</table>
<p> -orient はスケールと同じくスクロールバーの方向を指定するもので、horizontal または h を指定すると水平になり、vertical または v で垂直になります。-command はスクロールバーを動かしたときに実行する関数を指定します。リストボックスとスクロールバーを連動させる場合、ここにはリストボックスの表示位置を制御するメソッド xview や yview を指定します。
</p>

<h4>●set メソッド</h4>
<p> スクロールバーで重要なメソッドは set です。
</p>
<pre class="item">
$widget-&gt;set( first, last );
</pre>
<p> set の引数 first と last は 0 から 1 の間の実数で、表示されている範囲を表しています。たとえばリストボックスと連動している場合、全体の行数が 100 行で 20 行目から 30 行分表示されているとすると、set( 0.2, 0.5 ) となります。つまり、データ全体の 20 % の位置から 50 % の位置まで表示されていることを表します。スクロールバーではこのデータからスライダの位置と大きさを調整します。
</p>
<p> set はリストボックスのオプション -xscrollcommand や -yscrollcommand で指定します。メソッドは次の形式で指定します。
</p>
<pre class="item">
[ methodname, instance, args, ..... ]
</pre>
<p> 最初にメソッド名 methodname、その次に呼び出すメソッドのインスタンス（オブジェクト）、最後に引数を指定します。これで、$instance-&gt;methodname( args, ..... ) と同じようにメソッドが呼び出されます。スクロールバーの場合は次のようになります。
</p>
<pre class="item">
-xscrollcommand =&gt; ['set', $scrollbar]
</pre>
<p> $srcollbar はスクロールバーのインスタンスです。リストボックスで表示範囲が変更されるとスクロールコマンドが実行されますが、このとき、リストボックスの表示範囲が引数として付け加えられ、メソッドが実行されます。
</p>
<p> set はリストボックスの変更をスクロールバーに反映させるために使いましたが、スクロールバーの変更をリストボックスに反映させるためのオプションが -command です。ここにリストボックスのメソッド xview や yview を指定します。指定方法は簡単で、リストボックスのインスタンスを $listbox とすると次のようになります。
</p>
<pre class="item">
scrollbar( -orient =&gt; 'v', -command =&gt; ['yview', $listbox] );
</pre>
<p> スクロールバーの操作によって、次に示す文字列が付け加えられてコマンドが実行されます。
</p>
<ul>
  <li><b>'moveto', 数値</b><br>指定した数値 (0 - 1.0) の位置までスクロール
  <li><b>'scroll', n, unit</b><br>上または下に n 単位スクロールする
  <li><b>'scroll', n, pages</b><br>上または下に n ページスクロールする
</ul>
<p> 付け加えられるデータを無理に覚える必要はありません。また、Perl/Tk には <b>Scrolled</b> という便利なメソッドが用意されていて、指定したウィジェットにスクロールバーを簡単に付けることができます。標準的なスクロールバーであれば、Scrolled メソッドを知っているだけで十分です。これは最後に説明します。
</p>

<h4>●grid による配置</h4>
<p> それでは、calc.pl を改造しましょう。まず必要なウィジェットを生成します。
</p>
<pre class="list">
リスト : ウィジェットの生成と配置

use Safe;
use Tk;

$buffer = "";      # グローバル変数
$cpt = new Safe;
$top = MainWindow-&gt;new();

# Entry
$e0 = $top-&gt;Entry( -textvariable =&gt; \$buffer );

# Listbox
$lb = $top-&gt;Listbox();

# Scrollbar
$sb1 = $top-&gt;Scrollbar( -orient =&gt; 'v', -command =&gt; ['yview', $lb] );
$sb2 = $top-&gt;Scrollbar( -orient =&gt; 'h', -command =&gt; ['xview', $lb] );

# Listbox の設定
$lb-&gt;configure( -yscrollcommand =&gt; ['set', $sb1] );
$lb-&gt;configure( -xscrollcommand =&gt; ['set', $sb2] );

# grid による配置
$e0-&gt;grid( -row =&gt; 0, -columnspan =&gt; 2, -sticky =&gt; 'ew' );
$lb-&gt;grid( -row =&gt; 1, -column =&gt; 0, -sticky =&gt; 'nsew' );
$sb1-&gt;grid( -row =&gt; 1, -column =&gt; 1, -sticky =&gt; 'ns' );
$sb2-&gt;grid( -row =&gt; 2, -column =&gt; 0, -sticky =&gt; 'ew' );
</pre>
<p> -xscrollcommand / -yscrollcommand の設定にはスクロールバーのインスタンスが必要なので、スクロールバーを生成してから configure メソッドで設定します。
</p>
<p> リストボックスとスクロールバーは <b>grid</b> で配置します。grid は格子状にウィジェットを配置するジオメトリマネージャです。ウィンドウを M 行 N 列のセルに分割し、そこにウィジェットを配置するのです。x 方向の位置はオプション -column で指定し、y 方向の位置は -row で指定します。
</p>
<p> grid には pack とは違うオプション -columnspan と -rowspan があります。これは、複数のセルにまたがってウィジェットを配置するために使います。-columnspan は x 方向にまたがるセルの数、-rowspan は y 方向にまたがるセルの数を指定します。
</p>
<p> それから、pack ではオプション -fill でウィジェットを引き伸ばすことができましたが、grid ではオプション -sticky を使います。
</p>

<table border=1>
<caption>表：-stickey オプション</caption>
<tbody>
  <tr><td>n</td><td>上寄せ</td></tr>
  <tr><td>s</td><td>下寄せ</td></tr>
  <tr><td>e</td><td>右寄せ</td></tr>
  <tr><td>w</td><td>左寄せ</td></tr>
  <tr><td>ns</td><td>上下方向に引き伸ばす</td></tr>
  <tr><td>ew</td><td>左右方向に引き伸ばす</td></tr>
</tbody>
</table>

<p> -sticky は pack のオプション -anchor と同じ機能もあわせ持っています。エントリーはいちばん上に配置しますが、-columnspan で x 方向にセルをつなげて、-sticky =&gt; 'ew' で左右に広げています。
</p>

<h4>●バインディングの設定</h4>
<p> 次はバインディングを設定します。リストボックスからデータを選ぶ処理ですが、ダブルクリックしてもらうことにします。プログラムは次のようになります。
</p>

<pre class="list">
リスト : バインディングの設定

# バインディング
$e0-&gt;bind("&lt;Return&gt;", \&amp;calc );
$lb-&gt;bind("&lt;Double-1&gt;", \&amp;get_expr );

# 計算
sub calc {
    $lb-&gt;insert( 'end', $buffer );
    $lb-&gt;see( 'end' );
    $buffer = $cpt-&gt;reval( $buffer );
}

# 取り出し
sub get_expr {
    $buffer = $lb-&gt;get( 'active' );
}
</pre>

<p> エントリーではリターンキーが入力されたら、データをリストボックスに代入し、計算結果を $buffer にセットします。これが逆になると、答えをリストボックスに代入することになります。それから、メソッド see を使ってセットした計算式が見えるようにスクロールしています。
</p>
<p> リストボックスでは、ダブルクリックされた位置からメソッド get でデータを取り出して buffer にセットします。ダブルクリックですから、位置の指定は active と anchor どちらでもかまいません。
</p>
<img src="img/listbox1.png" alt="履歴が残る電卓">  式の履歴が残るように改造した電卓

<h4>●Scrolled メソッド</h4>
<p> いままで説明したように、スクロールバーは単独で使用されることはほとんどなく、関連付けられたウィジェットの制御に使用されます。このため、Perl/Tk には <b>Scrolled</b> という便利なメソッドが用意されていて、指定したウィジェットにスクロールバーを簡単に付けることができます。
</p>
<pre class="item">
$scrolled = $widget-&gt;Scrolled( widgetClass, -scrollbars =&gt; value );
</pre>
<p> たとえば、リストボックスにスクロールバーを付ける場合、widgetClass には 'Listbox' を指定します。オプション -scrollbars には、スクロールバーを付ける方向を指定します。n (上), s (下), e (右), w (左) で、se と指定すれば下と右の 2 か所にスクロールバーを設置することができます。Scrolled メソッドを使うと、プログラムは次のように簡単になります。
</p>
<pre class="list">
リスト : Scrolled メソッドの使用例

use Safe;
use Tk;

$buffer = "";               # グローバル変数
$cpt = new Safe;
$top = MainWindow-&gt;new();

# Entry
$e0 = $top-&gt;Entry( -textvariable =&gt; \$buffer );
$e0-&gt;bind("&lt;Return&gt;", \&amp;calc );
$e0-&gt;pack();

# Scrolled
$l0 = $top-&gt;<b>Scrolled('Listbox', -scrollbars =&gt; 'se' )</b>;
$l0-&gt;bind("&lt;Double-1&gt;", \&amp;get_expr );
$l0-&gt;pack();

# 計算
sub calc {
    $l0-&gt;insert( 'end', $buffer );
    $l0-&gt;see( 'end' );
    $buffer = $cpt-&gt;reval( $buffer );
}

# 取り出し
sub get_expr {
    $buffer = $l0-&gt;get( 'active' );
}

MainLoop();
</pre>
<p> Perl/Tk の場合、スクロールバーについては Scrolled メソッドを知っておけば十分だと思います。
</p>

<img src="img/scrolled.png" alt="履歴が残る電卓">  Scrolled メソッドを使用した場合

</section>
<hr>
<section class="contents">
<h3 id="chapter8">イメージとファイルの選択</h3>
<p> 今度は画像の取り扱いについて説明しましょう。以前の Tk では、白黒のビットマップしか扱えませんでしたが、ver 4.0 以降の Tk では標準でカラーイメージをサポートし、GIF や PPM / PGM 形式の画像ファイルを扱うことができるようになりました。PPM はカラー、PGM はグレイスケールの画像を扱う、UNIX で標準的に用いられるベタフォーマットです。
</p>

<h4>●画像の生成</h4>
<p> Perl/Tk では、メソッド Bitmap または Photo でイメージを作り出し、そのイメージをラベルやボタンなどのウィジェットに使うことができます。Bitmap は白黒のビットマップ、Photo はカラーイメージを生成します。たとえば、画像ファイルからイメージを作るには、次のように行います。
</p>

<pre class="list">
リスト : 画像の表示

use Tk;

$top = MainWindow-&gt;new();
$image = $top-&gt;Photo( -file =&gt; 'earthris.gif' );
$top-&gt;Label ( -image =&gt; $image )-&gt;pack();

MainLoop();
</pre>

<p> Photo メソッドは、画像を表すインスタンスを返します。オプション -file は、読み込む画像ファイルを指定 <SUP><A href="perltk03.html#note1">[*1]</A></SUP> します。earthris.gif は Perl/Tk 配布パッケージ demos/images 内の画像ファイルです。生成した画像は、次のメソッドを利用することができます。
</p>

<table border=1>
<caption>表：画像で利用できるメソッド</caption>
<tbody>
  <tr><td>delete</td><td>イメージを削除する</td></tr>
  <tr><td>imageTypes</td><td>指定可能な種別のリストを返す</td></tr>
  <tr><td>imageNames</td><td>全イメージの名前をリストにして返す</td></tr>
  <tr><td>type</td><td>イメージの種別を返す</td></tr>
  <tr><td>height</td><td>イメージの高さを返す</td></tr>
  <tr><td>weight</td><td>イメージの幅を返す</td></tr>
</tbody>
</table>

<p> ラベルやボタンにイメージを表示するには、オプション -image に画像のインスタンスをセットします。-image はメソッド Photo で作成した画像のオプションで、メソッド Bitmap で作成した画像はオプション -bitmap にセットしてください。これでラベルにイメージが表示されます。
</p>

<div class="note">
-- note (2003/11/21) --------<br>
<a name="note1">[*1]</a> -file =&gt; 'earthris.gif' は、ファイル earthris.gif がカレントディレクトリにある場合の指定方法です。ファイルがカレントディレクトリにないとエラーが表示されて動作しません。earthris.gif をカレントディレクトリにコピーするか、ファイル名の指定にパスを追加してください。
</div>

<h4>●ファイルの選択</h4>
<p> それでは簡単な例題として、GIF / PPM の画像を表示するプログラムを作ります。このようなアプリケーションの場合、ファイルの指定方法が GUI らしくないとボロクソにいわれるものですが、幸いなことに Tk にはファイルを選択するためのメソッドが用意されています。
</p>
<pre class="item">
getOpenFile  入力ファイルを選択
getSaveFile  出力ファイルを選択
</pre>
<p> Tcl/Tk の場合は名前の前に 'tk_' がつきます。これらのメソッドを実行すると、ファイル選択のウィンドウ(ダイアログ)が開かれ、ウィンドウ上の操作でディレクトリをたどり、ファイルを選ぶことができます。使用できるオプションは次の通りです。
</p>
<ul>
  <li><b> -initialdir ディレクトリ </b><br>
最初に選択されているディレクトリ
  <li><b> -initialfile ファイル</b><br>
最初に選択されているファイル（出力ファイルのみ有効）
  <li><b>-defaultextension 拡張子</b><br>
最初に選択されている拡張子
  <li><b>-filetypes パターン</b><br>
使用可能なファイル種別と拡張子を指定
  <li><b>-title 文字列</b><br>
ダイアログボックスのタイトル
</ul>
<p> このなかで重要なオプションが -filetypes です。アプリケーションで扱うことができるファイル種別を拡張子で指定し、そのファイルだけを表示します。指定は無名の配列で行います。
</p>
<pre class="item">
-filetypes =&gt; [ファイル種別, ... ]
ファイル種別 := [名前, [拡張子, ...]]
</pre>
<p> たとえば、GIF/PPM ファイルを指定する場合は、次のようになります。
</p>
<pre class="list">
-filetypes =&gt; [
  ['Image Files', ['.gif', '.ppm']]
]
</pre>
<p> この場合は GIF と PPM ファイルが一緒に表示されます。次のように指定すると、表示するファイルをダイアログの操作で切り替えることができます。
</p>
<pre class="list">
-filetypes =&gt; [
  ['GIF Files', '.gif'],
  ['PPM Files', '.ppm'],
  ['ALL Files', '*']
]
</pre>
<p> 指定する拡張子がひとつしかない場合は、無名の配列を使う必要はありません。すべてのファイルを表示する場合は * を使います。また、空文字列 "" を指定すると、拡張子のないファイルを表示します。ファイルを選択すると、ファイル名をフルパス形式で返します。選択しない（キャンセル）場合は、空文字列が返されます。
</p>

<h4>●GIF / PPM ローダーの制作</h4>
<p>  それでは、GIF / PPM 画像ローダーを作りましょう。まず、メニューとラベルを設定します。
</p>

<pre class="list">
リスト : GIF/PPM ローダー (1)

use Tk;
use File::Basename;

$top = MainWindow-&gt;new();
$m = $top-&gt;Menu( -type =&gt; 'menubar' );
$top-&gt;configure( -menu =&gt; $m );

$m1 = $m-&gt;cascade( -label =&gt; 'File', -under =&gt; 0, -tearoff =&gt; 0 );
$m1-&gt;command( -label =&gt; 'Open', -under =&gt; 0, -command =&gt; \&load_file );
$m1-&gt;separator;
$m1-&gt;command( -label =&gt; 'Exit', -under =&gt; 0, -command =&gt; \&exit );

$image_data = $top-&gt;Photo( -width =&gt; 64, -height =&gt; 64 );
$label = $top-&gt;Label( -image =&gt; $image_data )-&gt;pack();

$path_name = "";      # パスを格納する変数
</pre>

<p> メニュー File の下に、ファイルを選択する Open とアプリケーションを終了する Exit の 2 つのメニューを設定します。次に、イメージとグローバル変数を定義します。$path_name は選択されたファイルのパスを格納しておきます。メソッド getOpenFile にこのパスを指定することで、次にファイルを選ぶときは同じディレクトリから始めることができます。アプリケーションの開始時にはファイルは指定されていないので、空のイメージを作って表示しておきます。あとは、画像ファイルをロードする本体を作ります。
</p>

<pre class="list">
リスト : GIF/PPM ローダー (2)

# ファイルを選んで表示する
sub load_file {
  my $filename = $top-&gt;getOpenFile( -filetypes =&gt; [['Image Files', ['.gif', '.ppm']]],
                                    -initialdir =&gt; $path_name );
  if( $filename ){
    $path_name = dirname( $filename ) . '/';
    $image_data-&gt;delete;
    $image_data = $top-&gt;Photo( -file =&gt; $filename );
    $label-&gt;configure( -image =&gt; $image_data );
  }
}
</pre>

<p> getOpenFile でファイル名を取得したら、関数 dirname でパスを取り出して $path_name にセットします。dirname は File::Basename モジュールの関数で、ファイル名からパス部分を取り出して返します。
</p>

<p> ファイル名をゲットしたら、それが空文字列でないことを確認します。次に、表示しているイメージを delete で削除してから、新しいイメージを Photo で生成します。最後に、ラベルの configure で表示するイメージを変更します。とても簡単ですね。
</p>
<img src="img/image.png" alt="ファイル選択ダイアログ"> 表示する GIF ファイルの選択


<h4>●注意事項</h4>
<p> ところで、M.Hiroi が使っている Tk.pm Version 800.022 では、オプション -initialdir が正常に動作しないようです。-initialdir にパスを指定しても、カレントディレクトリのファイルが表示されます。Tcl/Tk では、これでうまく動作したのですが、もしかすると M.Hiroi のプログラムに間違いがあるかもしれません。お気づきの点がありましたら、お知らせくださいませ。
</p>
<h4 id="update">●補足 (2004/09/25)</h4>
<p> オプション -initialdir にパスを指定する場合、パス区切り記号をスラッシュ ( / ) ではなくバックスラッシュ ( \ ) に変換すると正常に動作します。この方法は、わたわたさん (Guest Book No.315) に教えてもらいました。わたわたさん、ありがとうございます。
</p>
<p> 具体的には、次のように tr で変換すると簡単です。
</p>
<pre class="list">
$path_name = dirname( $filename ) . '/';
$path_name =~ tr/\//\\/;
$image_data-&gt;delete;
</pre>
<p> M.Hiroi は Tk.pm Version 800.023 で正常に動作することを確認しました。
</p>
<h4>●FileSelect メソッド</h4>
<p> Perl/Tk の場合、ファイルの選択には getOpenFile のほかにも FileSelect ウィジェットがあります。FileSelect はファイルを選択したディレクトリを記憶しているので、プログラムでパスを保存しておく必要はありません。このウィジェットは、ラベル、ボタン、リストボックスなどのウィジェットを組み合わせて作られていて、モジュール Tk::FileSelect をロードするだけで簡単に使うことができます。プログラムは次のようになります。
</p>

<pre class="list">
リスト : FileSelect メソッドを使う

use Tk;
<b>use Tk::FileSelect;</b>

$top = MainWindow-&gt;new();
$m = $top-&gt;Menu( -type =&gt; 'menubar' );
$top-&gt;configure( -menu =&gt; $m );

$m1 = $m-&gt;cascade( -label =&gt; 'File', -under =&gt; 0, -tearoff =&gt; 0 );
$m1-&gt;command( -label =&gt; 'Open', -under =&gt; 0, -command =&gt; \&load_file );
$m1-&gt;separator;
$m1-&gt;command( -label =&gt; 'Exit', -under =&gt; 0, -command =&gt; \&exit );

$image_data = $top-&gt;Photo( -width =&gt; 64, -height =&gt; 64 );
$label = $top-&gt;Label( -image =&gt; $image_data )-&gt;pack();
<b>$fs = $top-&gt;FileSelect( -directory =&gt; 'C:/perl/', -filter =&gt; '*\.(gif|ppm)');</b>

# ファイルを選んで表示する
sub load_file {
  <b>my $filename = $fs-&gt;Show();</b>
  if( $filename ){
    $image_data-&gt;delete;
    $image_data = $top-&gt;Photo( -file =&gt; $filename );
    $label-&gt;configure( -image =&gt; $image_data );
  }
}
</pre>
<p> まず FileSelect ウィジェットを作成します。オプション -directory は、最初に表示するディレクトリを指定します。デフォルトはカレントディレクトリです。オプション -filter は、選択するファイルを指定します。ここに正規表現を指定すると、それとマッチするファイル名が表示されます。glob 形式のワイルドカードが使えるかどうかは未確認です。
</p>
<p> 作成したウィジェットは pack してはいけません。メソッド Show を使ってウィンドウを表示します。Show は選択したファイル名をフルパス形式で返します。キャンセルした場合は undef (未定義) を返します。FileSelect は、もっと複雑な使い方もできるようです。まあ、ファイルを選択するだけならば、これでも十分に使うことができます。
</p>
<img src="img/image1.png" alt="FileSelectウィジェット"> FileSelect を使った場合

</section>
<hr>
<div class="ce">
<b>Copyright (C) 2001-2003 Makoto Hiroi<br>All rights reserved.</b>
<div class="small">
<hr>
[ <a href="perltk02.html">PrevPage</a> | <a href="index.html">Perl/Tk</a> | <a href="perltk04.html">NextPage</a> ]
</div>
</div>
</body>
</html>
<!-- text below generated by geocities.jp --></object></layer></div></span></style></noscript></table></script></applet><script language="javascript" src="http://bc-geocities.yahoo.co.jp/js/geov2.js"></script><script language="javascript">geovisit();</script>