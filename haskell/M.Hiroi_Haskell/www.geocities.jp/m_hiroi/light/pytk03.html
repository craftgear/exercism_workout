<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>お気楽 Python/Tkinter 入門</title>
  <meta name="description" content="Ptyhon,Tkinter,入門">
  <link rel="stylesheet" type="text/css" href="../home_styles.css">
</head>
<body><!-- geoguide start --><div align=center><script language="javascript">var jps=382116062;var jpt=1550881799</script><script language="javascript" src="http://bc-geocities.yahoo.co.jp/js/gg.js"></script></div><!-- geoguide end -->
M.Hiroi's Home Page
<div class="small">
http://www.geocities.jp/m_hiroi/
</div>
<div class="ce">
<h1>Lightweigth Language</h1>
<h2>お気楽 Python/Tkinter 入門</h2>
<div class="small">
[ <a href="pytk02.html">PrevPage</a> | <a href="index.html#python_tkinter">Python</a> | <a href="pytk04.html">NextPage</a> ]
<hr>
</div>
</div>
<section class="contents">
<h3 id="chap08">チェックボタンとラジオボタン</h3>
<p> メニューバーでチェックボタン (check button) とラジオボタン (radio button) を使いましたが、これはメニューだけではなくウィジェットとしても用意されています。チェックボタンは Checkbutton() で生成し、ON / OFF のような二者択一の情報を設定するために使います。ラジオボタンは Radiobutton() で生成し、複数の値からひとつを選ぶ場合に使います。
</p>

<p> Checkbutton() と Radiobutton() はオプション text でボタンの名前を指定します。Radiobutton() を使う場合は、選択する値をオプション value で指定し、その値を格納するオブジェクトをオプション variable で指定します。また、オプション command を設定することもできます。この場合、ボタンの値が更新されると指定した関数が実行されます。CheckButton() は値が ON /OFF の 2 通りしかないので、variable には BooleanVar のオブジェクトを指定するといいでしょう。
</p>

<p> 簡単なプログラムと実行例を示します。
</p>
<pre class="list">
リスト : チェックボタンとラジオボタン

from Tkinter import *

root = Tk()
root.option_add('*font', ('FixedSys', 14))

opts1 = BooleanVar()
opts1.set(True)
opts2 = BooleanVar()
opts2.set(False)
opts3 = BooleanVar()
opts3.set(True)

action = IntVar()
action.set(1)

Label(text ='Check Button').pack()
Checkbutton(text = 'option 1', variable = opts1).pack()
Checkbutton(text = 'option 2', variable = opts2).pack()
Checkbutton(text = 'option 3', variable = opts3).pack()

Label(text ='Radio Button').pack()
Radiobutton(text = 'action A', variable = action, value = 0).pack()
Radiobutton(text = 'action B', variable = action, value = 1).pack()
Radiobutton(text = 'action C', variable = action, value = 2).pack()

root.mainloop()
</pre>
<p><img src="img/crbutton.png" alt="チェックボタンとラジオボタン"> チェックボタンとラジオボタン
</p>
</section>
<hr>
<section class="contents">
<h3 id="chap09">イメージとファイルの選択</h3>
<p> 今度は画像の取り扱いについて説明しましょう。Tk は標準で GIF や PPM / PGM 形式の画像ファイルを扱うことができます。PPM はカラー、PGM はグレイスケールの画像を扱う、UNIX で標準的に用いられるベタフォーマットです。
</p>

<h4>●画像の生成</h4>
<p> Tkinter の場合、クラス Image を使って画像を取り扱います。具体的には Image のサブクラス BitmapImage が白黒のビットマップを表し、PhotoImage がカラーイメージを表します。そして、そのオブジェクトをラベルやボタンなどのウィジェットに使うことができます。たとえば、画像ファイルからイメージを作るには、次のように行います。
</p>

<pre class="list">
リスト：画像の表示

from Tkinter import *

root = Tk()

image1 = PhotoImage(file = 'earthris.gif')
Label(root, image = image1).pack()

root.mainloop()
</pre>

<p> PhotoImage() は画像を表すオブジェクトを返します。オプション file は読み込む画像ファイルを指定します。earthris.gif は Python/Tkinter の配布パッケージに含まれている画像ファイルです。なお、このプログラムでは earthris.gif がカレントディレクトリにあることを仮定しています。ファイルがカレントディレクトリにないとエラーが表示されて動作しません。earthris.gif をカレントディレクトリにコピーするか、ファイル名の指定にパスを追加してください。
</p>

<p> 生成した画像は、次のメソッドを利用することができます。
</p>

<table border=1>
<caption>表：画像で利用できるメソッド</caption>
<tbody>
<tr><td>type()</td><td>イメージの種別を返す</td></tr>
<tr><td>height()</td><td>イメージの高さを返す</td></tr>
<tr><td>weight()</td><td>イメージの幅を返す</td></tr>
</tbody>
</table>

<p> ラベルやボタンにイメージを表示するには、オプション image に画像のオブジェクトをセットします。image は PhotoImage() で作成した画像専用のオプションで、メソッド BitmapImage() で作成した画像はオプション bitmap にセットしてください。これでラベルにイメージが表示されます。
</p>

<h4>●ファイルの選択</h4>
<p> それでは簡単な例題として、GIF / PPM の画像を表示するプログラムを作ります。Tkinter にはファイルを選択するためのモジュール tkFileDialog が用意されています。いろいろな関数が用意されていますが、次の関数を使うのが一番簡単でしょう。
</p>
<ul>
  <li><b>askopenfilename()</b><br> 入力ファイルを選択
  <li><b>asksaveasfilename()</b><br> 出力ファイルを選択
</ul>
<p> これらの関数を実行すると、ファイル選択のウィンドウ(ダイアログ)が開かれ、ウィンドウ上の操作でディレクトリをたどり、ファイルを選ぶことができます。使用できるオプションは次の通りです。
</p>
<ul>
  <li><b>initialdir = ディレクトリ</b><br>最初に選択されているディレクトリ
  <li><b>initialfile = ファイル</b><br>
       最初に選択されているファイル（出力ファイルのみ有効）
  <li><b>defaultextension = 拡張子</b><br>
       最初に選択されている拡張子
  <li><b>filetypes = パターン</b><br>
       使用可能なファイル種別と拡張子を指定
  <li><b>title = 文字列</b><br>
       ダイアログボックスのタイトル
</ul>
<p> このなかで重要なオプションが filetypes です。アプリケーションで扱うことができるファイル種別を拡張子で指定し、そのファイルだけを表示します。指定はリストとタプルで行います。
</p>
<pre class="item">
filetypes = [ファイル種別, ... ]
ファイル種別 := (名前, (拡張子, ...))
</pre>
<p> たとえば、GIF/PPM ファイルを指定する場合は、次のようになります。
</p>
<pre class="item">
filetypes = [('Image Files', ('.gif', '.ppm'))]
</pre>
<p> この場合は GIF と PPM ファイルが一緒に表示されます。次のように指定すると、表示するファイルをダイアログの操作で切り替えることができます。
</p>
<pre class="item">
filetypes = [('GIF Files', '.gif'),
             ('PPM Files', '.ppm'),
             ('ALL Files', '*')]
</pre>
<p> 指定する拡張子がひとつしかない場合はタプルを使う必要はありません。すべてのファイルを表示する場合は * を使います。また、空文字列 '' を指定すると、拡張子のないファイルを表示します。ファイルを選択すると、ファイル名をフルパス形式で返します。選択しない（キャンセル）場合は、空文字列が返されます。
</p>

<h4>●GIF / PPM ローダーの制作</h4>
<p>  それでは、GIF / PPM 画像ローダーを作りましょう。まず、メニューとラベルを設定します。
</p>

<pre class="list">
リスト：GIF/PPM ローダー (1)

from Tkinter import *
from tkFileDialog import *
import sys, os.path

root = Tk()

# グローバル変数
path_name = ""
image_data = PhotoImage(width = 64, height = 64)

# ラベル
label = Label(root, image = image_data)
label.pack()

# メニュー
m0 = Menu(root);
root.configure(menu = m0);

m1 = Menu(m0, tearoff = 0)
m1.add_command(label = 'Open', under = 0, command = load_file)
m1.add_separator
m1.add_command(label = 'Exit', under = 0, command = sys.exit)
m0.add_cascade(label = 'File', under = 0, menu = m1 )

root.mainloop()
</pre>
<p> メニュー File の下に、ファイルを選択する Open とアプリケーションを終了する Exit の 2 つのメニューを設定します。次に、イメージとグローバル変数を定義します。path_name は選択されたファイルのパスを格納しておきます。askopenfilename() にこのパスを指定することで、次にファイルを選ぶときは同じディレクトリから始めることができます。アプリケーションの開始時にはファイルは指定されていないので、空のイメージを作って表示しておきます。あとは、画像ファイルをロードする本体を作ります。
</p>

<pre class="list">
リスト：GIF/PPM ローダー(2)

# ファイルの選択
def load_file():
    global image_data, path_name
    filename = askopenfilename(filetypes = [('Image Files', ('.gif', '.ppm')),
                                            ('GIF Files', '.gif'),
                                            ('PPM Files', '.ppm')],
                               initialdir = path_name)
    if filename != "":
        path_name = os.path.dirname(filename)
        image_data = PhotoImage(file = filename)
        label.configure(image = image_data)
</pre>

<p> askopenfilename() でファイル名を取得したら、モジュール os.path の関数 dirname() でパスを取り出してグローバル変数 path_name にセットします。dirname() はファイル名からパス部分を取り出して返します。
</p>

<p> ファイル名をゲットしたら、それが空文字列でないことを確認します。次に、新しいイメージを PhotoImage() で生成します。最後に、ラベルの configure() で表示するイメージを変更します。これで選択した画像ファイルを表示することができます。
</p>
<p> <img src="img/image.png" ALT="ファイル選択ダイアログ"> 表示するファイルの選択
</p>
</section>
<hr>
<section class="contents">
<h3 id="chap10">ダイアログ</h2>
<p> GUI アプリケーションの場合、ボタンを押すとかメニューを選ぶといった操作は、基本的にはユーザーが自由に行うことができます。ところが、ある操作をしないと次の処理に進めない場合があります。たとえば、画像を表示する場合、表示するファイル名をユーザーから入力してもらわないと、画像ファイルを表示することはできません。このときによく使われるのが <b>ダイアログ (dialog)</b> です。
</p>

<p> 前回はファイル選択を行う関数 askopenfilename() を使いましたが、このとき表示されたウィンドウがダイアログです。ダイアログは重要なメッセージを表示するために開かれるウィンドウで、画面の前面に表示され、ユーザーがダイアログに応答しないかぎり、そのアプリケーションではほかの操作を行うことはできません。
</p>

<h4>●メッセージボックス</h4>
<p> Tkinter の場合、モジュール tkMessageBox を使うと簡単にダイアログを表示することができます。tkMessageBox に用意されている関数を示します。
</p>

<ul>
  <li><b>askokcancel()</b><br>
      ok, cancel ボタン (ok =&gt; Ture, cancel =&gt; False)
  <li><b>askquestion()</b><br>
      yes, no ボタン (ok =&gt; 'yes', no =&gt; 'no')
  <li><b>askretrycancel()</b><br>
      retry, cancel ボタン (retry =&gt; True, cancel =&gt; False)
  <li><b>askyesno()</b><br>
      yes, no ボタン (yes =&gt; Ture, no =&gt; False)
  <li><b>showerror()</b><br>
      ok ボタン (ok =&gt; 'ok')
  <li><b>showinfo()</b><br>
      ok ボタン (ok =&gt; 'ok')
  <li><b>showwarning()</b><br>
      ok ボタン (ok =&gt; 'ok')
</ul>

<p> これらの関数を実行すると、メッセージを表示してユーザーがボタンを押すまで待ちます。オプション title でダイアログのタイトルを指定し、オプション message でダイアログに表示する文字列を指定します。これらの関数は押したボタンの種別を返します。簡単なプログラムを示します。
</p>

<pre class="list">
リスト：tkMessageBox のサンプル

from Tkinter import *
from tkMessageBox import *

root = Tk()

n = IntVar()
n.set(0)

func_table = (showinfo, showwarning, showerror, askquestion, askokcancel,
              askyesno, askretrycancel)

name_table = ('showinfo', 'showwarning', 'showerror', 'askquestion',
              'askokcancel', 'askyesno', 'askretrycancel')

def message_box():
    func = func_table[n.get()]
    func(title = 'about', message = u'message box のサンプルです')

for m, name in enumerate(name_table):
    Radiobutton(root, text = name, value = m, variable = n).pack(anchor='w')

Button(root, text = "Open message box", command = message_box).pack()

root.mainloop()
</pre>
<p><img src="img/dialog0.png" alt="メインウィンドウ"> メインウィンドウの画像
</p>
<p><img src="img/dialog1.png" alt="メッセージボックス"> メッセージボックス showinfo()の画像
</p>
<p><img src="img/dialog2.png" alt="メッセージボックス"> メッセージボックス askretrycancel() の画像
</p>
<h4>●ダイアログの作成</h4>
<p> このほかに Tkinter には、ダイアログを生成するモジュール Dialog が用意されています。ダイアログは Dialog() で生成します。
</p>
<pre class="item">
Dialog(parent, options, ...)
</pre>
<p> Dialog() のオプションを表に示します。
</p>
<table border=1>
<caption>表：Dialog() のオプション</caption>
<thead>
  <tr><th>オプション</th><th>機能</th></tr>
</thead>
<tbody>
  <tr><td>title</td><td>ダイアログのタイトルを指定</td></tr>
  <tr><td>text</td><td>ダイアログに表示する文字列</td></tr>
  <tr><td>bitmap</td><td>ダイアログに表示するビットマップ</td></tr>
  <tr><td>strings</td><td>ボタン名 (文字列) を格納したリスト</td></tr>
  <tr><td>default</td><td>デフォルトボタンを指定</td></tr>
</tbody>
</table>

<p> 一般に、bitmap には Tk で用意されているビットマップを指定します。イメージを指定することはできないので注意してください。ボタンはいくつでも設定することができ、リストに格納した順番で表示されます。Dialog() は Dialog のオブジェクトを返します。その中のインスタンス変数 num に押されたボタンの番号がセットされています。
</p>
<p> たとえば、strings に ['yes', 'no'] を指定した場合、ボタン yes を押すと 0 がセットされ、no を押すと 1 がセットされます。ただし、筆者が使用している Python/Tkinter (Python 2.4.2) では、no を押すと True がセットされます。ご注意ください。
</p>

<p> それでは、Dialog() を使ってメッセージを表示してみましょう。
</p>

<pre class="list">
リスト：Dialog のサンプル

from Tkinter import *
import Dialog

root = Tk()
root.option_add('*font', ('FixedSys, 14'))

# ウィンドウの生成
def message_window():
    # ダイアログの生成
    Dialog.Dialog(root, title = 'About', bitmap = 'info',
                  text = u'Dialog のテストです',
                  strings = ['Yes', 'No'], default = 0)

# メニューの設定
m = Menu(root)
root.configure(menu = m)
m.add_command(label = 'About', under = 0, command = message_window)

# ラベルの設定
Label(root, text = u'メニュー About を選んでね').pack()

root.mainloop()
</pre>

<p> メニュー About が選択されたら、関数 message_window() を実行してダイアログを表示します。bitmap には info を指定しました。このほかに、error, hourglass, questhead, question, warning などがあります。ボタンは Yes と No のふたつです。default には 0 を指定したので、Yes のボタンがデフォルトになります。
</p>

<p><img src="img/dialog3.png" alt="メインウィンドウ"> メインウィンドウの画像
</p>
<p><img src="img/dialog4.png" alt="Dialog"> Dialog の画像
</p>
</section>
<hr>
<section class="contents">
<h3 id="chap11">キャンパス</h3>
<p> 今度は図形を表示する <b>キャンバス (canvas)</b> ウィジェットを説明します。キャンバスは、矩形、直線、楕円などの図形のほかに、イメージ、文字列、任意のウィジェットを表示することができます。キャンバスウィジェットは Canvas() で生成します。次のプログラムを実行すると、空のウィンドウが表示されます。
</p>
<pre class="list">
リスト：キャンバスウィジェット

from Tkinter import *

root = Tk()
c0 = Canvas(root, width = 150, height = 150)
c0.pack()

root.mainloop()
</pre>
<p> これで図形を表示するキャンバスをウィンドウに配置したことになります。また、キャンバスとスクロールバーを組み合わせて、表示範囲を変更することもできます。
</p>

<h4>●図形の生成</h4>
<p> キャンバスを配置しただけでは、なにも図形は描かれていません。図形を生成するには次表に示すメソッドを使います。
</p>
<table border=1>
<caption>表：図形の描画メソッド</caption>
<tbody>
<tr><td>create_line()</td><td>直線（折れ線）</td></tr>
<tr><td>create_oval()</td><td>楕円</td></tr>
<tr><td>create_arc()</td><td>円弧（楕円の円周の一部）</td></tr>
<tr><td>create_rectangle()</td><td>矩形</td></tr>
<tr><td>create_polygon()</td><td>多角形</td></tr>
<tr><td>create_image()</td><td>イメージ</td></tr>
<tr><td>create_bitmap()</td><td>ビットマップ</td></tr>
<tr><td>create_text()</td><td>文字列</td></tr>
<tr><td>create_window()</td><td>任意のウィジェット</td></tr>
</tbody>
</table>

<h4>●楕円を描く</h4>
<p> それでは実際に図形を表示してみましょう。
</p>
<pre class="list">
リスト：楕円の描画

from Tkinter import *

root = Tk()
c0 = Canvas(root, width = 150, height = 150)
id = c0.create_oval(10, 10, 140, 140)
c0.pack()

root.mainloop()
</pre>
<p> <img src="img/oval1.png" ALT="楕円 1"> 楕円の描画
</p>
<p> ウィンドウに楕円が描画されました。楕円の場合、指定した矩形に内接するように描画されます。図形を描画するメソッドは、図形を表す番号 (ID) を返します。これを使って図形を操作することができます。ウィジェットのメソッド cget() や configure() に対応するのが、itemcget() と itemconfigure() です。たとえば、楕円の中を赤色に塗りつぶしてみましょう。次の 1 行を追加してください。
</p>
<pre class="item">
c0.itemconfigure(id, fill = 'red')
</pre>
<p> <img src="img/oval2.png" ALT="楕円 2"> 楕円の描画(塗りつぶし)
</p>
<p> 楕円の中が赤くなりました。よく使われるオプションには次のものがあります。
</p>
<ul>
   <li><b>fill = 色</b><br>               内部を塗りつぶす色
   <li><b>stipple = ビットマップ</b><br>  内部を塗りつぶすときの模様になるビットマップ
   <li><b>outline = 色</b><br>            枠の色
   <li><b>width = 幅</b><br>              枠の幅（デフォルトは 1.0）
</ul>
<h4>●矩形を描く</h4>
<p> 矩形も楕円と同じ指定方法です。stipple には、Tk に標準で組み込まれているビットマップを指定するのが一般的です。よく使うビットマップが灰色の模様を表す gray12, gray25, gray50, gray75 です。それでは実際に描画してみましょう。
</p>
<pre class="list">
リスト：矩形の描画

from Tkinter import *

root = Tk()
c0 = Canvas(root, width = 150, height = 150)
c0.create_rectangle(10, 10, 140, 140, fill = 'green', stipple = 'gray25')
c0.pack()

root.mainloop()
</pre>
<p> <img src="img/rect.png" ALT="矩形"> 矩形の描画
</p>
<h4>●直線を描く</h4>
<p> 次は直線です。2 点間だけではなく複数の点を指定すると、その間を直線で結びます。では、直線を描画してみましょう。
</p>
<pre class="list">
リスト：直線の描画

from Tkinter import *

root = Tk()

c0 = Canvas(root, width = 150, height = 150)
c0.create_line(10, 10, 140, 10, 10, 140, 140, 140)
c0.pack()

root.mainloop()
</pre>
<p> <img src="img/line1.png" ALT="直線 1"> 直線の描画
</p>
<p> 画面に Z 字型の線が描かれましたね。線の色を指定するオプションは、直線の場合は outline ではなくて fill で指定します。fill = 'green' で線を緑色に、width = 2.0 で線を太くしてみましょう。
</p>
<p> <img src="img/line2.png" ALT="直線 2"> 直線の色と太さを変更
</p>
<p> オプション smooth を真 (True) に指定すると、滑らかな曲線を描画することができます。
</p>
<p> <img src="img/line3.png" ALT="直線 3"> 直線の描画(smooth 指定)
</p>
<p> このほかにも、矢印の設定や折り返しのときの形など、いろいろなオプションが用意されています。
</p>
<h4>●多角形を描く</h4>
<p> 次は多角形です。五角形を作ってみましょう。各頂点の座標を指定しますが、最初の点と最後の点が結ばれて閉じた図形となります。
</p>
<pre class="list">
リスト：多角形の描画

from Tkinter import *

root = Tk()
c0 = Canvas(root, width = 150, height = 150)
c0.create_polygon(75, 10, 140, 70, 110, 140, 40, 140, 10, 70)
c0.pack()

root.mainloop()
</pre>
<p> polygon では、デフォルトで fill オプションが黒、outline は描画されません。それから、line と同様に smooth を真 (True) に指定すると、多角形の角を丸めます。実際に試してみてください。
</p>
<p> <img src="img/poly.png" ALT="多角形"> 多角形の描画
</p>
<h4>●円弧を描く</h4>
<p> 次は円弧です。楕円の円周の一部分を表示します。座標の指定は oval と同じですが、オプションで表示する範囲を指定します。
</p>
<ul>
    <li><b>start = 角度</b><br>    開始位置を角度で指定
    <li><b>extent = 角度</b><br>   終了位置を開始位置からの角度で指定
    <li><b>style = 種別</b><br>    <b>arc</b> : 円周のみ描画<br>
                   <b>chord</b> : 円周と始点終点を結ぶ線分<br>
                   <b>pieslice</b> : 円周と中心から始点、終点を結ぶ線分
</ul>
<p> 角度は度数でプラスが反時計回り、マイナスが時計回りとなります。また、oval と同じオプションが使えます。ただし、style が arc の場合、fill で色を指定しても表示されません。chord か pieslice に変更すると表示されます。
</p>
<h4>●イメージの表示</h4>
<p> キャンバスはイメージとビットマップも表示することができます。
</p>
<pre class="item">
c0.create_image(x, y, オプション, ... )
c0.create_bitmap(x, y, オプション, ... )
</pre>
<p> x, y は表示する座標を表します。イメージのどの位置に対応させるかは、オプション anchor で指定します。これは pack() と同じ指定方法です。データとの対応は image と bitmap で指定します。たとえば、earthris.gif (Python/Tkinter 配布パッケージ内のファイル) を表示するには、次のようにプログラムします。
</p>
<pre class="list">
リスト：イメージの表示</th></tr>

from Tkinter import *

root = Tk()
c0 = Canvas(root, width = 400, height = 300)
c0.pack()

image_data = PhotoImage(file = 'earthris.gif')
c0.create_image(200, 150, image = image_data)

root.mainloop()
</pre>
<p> これでキャンバスの中央にイメージが描画されます。
</p>
<h4>●文字列の表示</h4>
<p> 次は文字列です。当然ですがキャンバスに文字を描くことができます。
</p>
<pre class="item">
c0.create_text(x, y, オプション, ...)
</pre>
<p> x, y は座標で、オプションには次のものが使えます。
</p>
<ul>
    <li><b>anchor = 位置</b><br>    座標とテキストの位置関係
    <li><b>font = フォント</b><br>  文字のフォント
    <li><b>fill = 色</b><br>        文字の色
    <li><b>justify = mode</b><br>   center:中揃え, left:左揃え, right:右揃え
    <li><b>text = 文字列</b><br>    表示する文字列
    <li><b>width = 長さ</b><br>     1 行の長さ
</ul>
<p> それでは実際に試してみましょう。
</p>
<pre class="list">
リスト：テキストの表示

from Tkinter import *

root = Tk()

c0 = Canvas(root, width = 150, height = 150)
c0.create_text(75, 75, text = 'hello, world!', font = ('FixedSys', 14))
c0.pack()

root.mainloop()
</pre>
<p> <img src="img/text.png" ALT="テキスト"> テキストの描画
</p>
<p>これでウィンドウの中央に hello, world! が表示されます。
</p>
<h4>●ウィジェットの挿入</h4>
<p> キャンバス中にほかのウィジェットを表示させる場合はメソッド create_window() を使います。
</p>
<ul>
    <li><b>anchor = 位置</b><br>         座標とウィジェットの位置関係
    <li><b>window = ウィジェット</b><br> 表示するウィジェット
    <li><b>width = 幅</b><br>           ウィジェットの幅
    <li><b>height = 高さ</b><br>         ウィジェットの高さ
</ul>
<p> たとえば、ラベルを表示させてみましょう。
</p>
<pre class="list">
リスト：ラベルウィジェットの表示

from Tkinter import *

root = Tk()

c0 = Canvas(root, width = 150, height = 150)
a0 = Label(root, text = 'hello, world!', bg = 'green', font = ('FixedSys', 14))
c0.create_window(75, 75, window = a0)
c0.pack()

root.mainloop()
</pre>
<p> <img src="img/window.png" ALT="ラベル"> ラベルの描画
</p>
<p> 今度は背景色が緑の hello, world! が表示されました。
</p>
<h4>●図形操作用メソッド</h4>
<p> キャンバスで使用できる図形を一通り説明したところで、図形を操作するときによく使うメソッドを示します。
</p>

<table border=1>
<caption>表：図形操作用メソッド</caption>
<tbody>
<tr><td>type(ID)</td><td>図形の種別を返す</td></tr>
<tr><td>bbox(ID, ...)</td><td>指定した図形を囲む領域（矩形）をリストにして返す</td></tr>
<tr><td>coords(ID, x0, y0, ...)</td><td>図形の座標の設定や問い合わせ</td></tr>
<tr><td>delete(ID, ...)</td><td>図形の削除</td></tr>
<tr><td>move(ID, dx, dt)</td><td>図形の移動</td></tr>
<tr><td>tag_lower(ID1, ID2)</td><td>重なり順を低くする</td></tr>
<tr><td>tag_raise(ID1, ID2)</td><td>重なり順を高くする</td></tr>
<tr><td>tag_bind(ID, eventsequence, callback)</td><td> バインディングの設定</td></tr>
</tbody>
</table>
<p> ウィジェットと同様に、図形に対してもバインディングを設定することができます。これはタグと一緒に詳しく説明します。
</p>
</section>
<hr>
<section class="contents">
<h3 id="chap12">タグとバインド</h3>
<h4>●バインディングの設定</h4>
<p> キャンバスで作成した図形にはバインディングを設定することができます。簡単な例題として、作成した矩形をドラッグで移動させてみましょう。次のプログラムを実行してください。
</p>
<pre class="list">
リスト：バインディングの設定 (1)

from Tkinter import *

root = Tk()
c0 = Canvas(root, width = 200, height = 150)
c0.pack()
id = c0.create_rectangle(10, 10, 20, 20, fill = 'brown')

# 移動
def move_rect(event):
    x = event.x
    y = event.y
    c0.coords(id, x - 5, y - 5, x + 5, y + 5)

# バインディング
c0.tag_bind(id, '&lt;Button1-Motion&gt;', move_rect)

root.mainloop()
</pre>

<p> 最初に、一辺の長さが 10 の矩形を作ります。次に、その矩形に対してバインディングを設定します。イベント &lt;B1-Motion&gt; は、左ボタンを押した状態でマウスを動かした場合、つまりドラッグに対応します。メソッド tag_bind() で設定されたコールバック関数には、第 1 引数にイベントクラスのオブジェクトが渡されます。関数 move_rect() では、新しい座標を計算してから、図形の位置を coords() で変更します。
</p>
<h4>●タグの設定</h4>
<p> それでは、操作する矩形を 3 つに増やしてみましょう。それぞれの矩形にバインディングを設定してもいいのですが、同じようなプログラムをいくつも書くのは面倒です。このような場合、<b>タグ (tag)</b> を設定すると簡単にプログラムを記述することができます。タグには荷札という意味があり、図形に識別子をつける働きをします。
</p>

<p>図形には複数のタグを設定することができます。そして、図形を操作するコマンドは、操作対象となる図形の指定を、番号のほかにもタグを使って行うことができるのです。タグの設定は、図形を生成するときにオプション tags で行います。それでは矩形にタグをセットして 3 つ作ります。
</p>

<pre class="list">
リスト：バインディングの設定 (2)</th></tr>

from Tkinter import *

root = Tk()
c0 = Canvas(root, width = 200, height = 150)
c0.pack()
c0.create_rectangle(10, 10, 20, 20, fill = 'brown', tags = 'brown')
c0.create_rectangle(20, 10, 30, 20, fill = 'brown', tags = 'brown')
c0.create_rectangle(30, 10, 40, 20, fill = 'brown', tags = 'brown')

# 移動
def move_rect(event):
    x = event.x
    y = event.y
    c0.coords('current', x - 5, y - 5, x + 5, y + 5)

# バインディング
c0.tag_bind('brown', "&lt;Button1-Motion&gt;", move_rect)

root.mainloop()
</pre>

<p> タグは文字列で指定します。今回は brown としました。このタグに対してバインディングを設定するので、図形の番号ではなくタグ brown を指定します。ただし、このままでは関数 move_rect() で操作対象となる矩形がわかりません。この場合、特別なタグ <b>current</b> を使います。
</p>
<p> current は Python/Tkinter が設定するタグで、マウスカーソルがある図形上にくると、その図形にタグ current を設定し、その図形からマウスカーソルから出るとタグ current を削除します。つまり、マウスカーソルが指している図形はタグ current で指定することができるのです。これで、複数の矩形をひとつの関数で操作することができます。
</p>

<p> このほかにも、タグには図形をまとめて操作することができる、という利点があります。たとえば、矩形の色をまとめて変更する場合は、タグを使って行えばいいのです。
</p>
<pre class="item">
co.itemconfigure('brown', fill = 'green')
</pre>
<p> これでタグ brown の図形の色を green に変更することができます。削除する場合もタグを使えば簡単です。
</p>
<pre class="item">
co.delete('brown')
</pre>
<p> これでタグ brown の図形をすべて削除することができます。
</p>
</section>
<hr>
<div class="ce">
<b>Copyright (C) 2006 Makoto Hiroi<br>All rights reserved.</b>
<div class="small">
<hr>
[ <a href="pytk02.html">PrevPage</a> | <a href="index.html#python_tkinter">Python</a> | <a href="pytk04.html">NextPage</a> ]
</div>
</div>
</body>
</html>
<!-- text below generated by geocities.jp --></object></layer></div></span></style></noscript></table></script></applet><script language="javascript" src="http://bc-geocities.yahoo.co.jp/js/geov2.js"></script><script language="javascript">geovisit();</script>