<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>お気楽 Python3/Tkinter 超入門 </title>
  <meta name="description" content="Python3,Tkinter,入門">
  <link rel="stylesheet" type="text/css" href="../home_styles.css">
</head>
<body><!-- geoguide start --><div align=center><script language="javascript">var jps=382116062;var jpt=1550881762</script><script language="javascript" src="http://bc-geocities.yahoo.co.jp/js/gg.js"></script></div><!-- geoguide end -->
M.Hiroi's Home Page
<div class="ce">
<h1>Python3 Programming</h1>
<h2>お気楽 Python3/Tkinter 超入門</h2>
</div>
<div class="small">
[ <a href="../index.html">Home</a> | <a href="index.html">Light</a> | <a href="python3.html#python3_tkinter">Python3</a> ]
<hr>
</div>
<section class="contents">
<h4 id="chap18">●メッセージボックス</h4>
<ul>
  <li>ダイアログ (dialog) は重要なメッセージを表示するために開かれるウィンドウ</li>
  <li>ユーザーがダイアログに応答しない限り、そのアプリケーションでは他の操作を行うことはできない</li>
  <li>Tkinter の場合、モジュール messagebox を使うと簡単にダイアログを表示することができる</li>
  <ul> 
    <li>Python2 は tkMessageBox だったが、Python3 からは messagebox になった</li>
  </ul>
  <li>messagebox に用意されている関数を以下に示す</li>
  <ul>
    <li>askokcancel()<br>
      ok, cancel ボタン (ok =&gt; Ture, cancel =&gt; False)
    <li>askquestion()<br>
      yes, no ボタン (ok =&gt; 'yes', no =&gt; 'no')
    <li>askretrycancel()<br>
      retry, cancel ボタン (retry =&gt; True, cancel =&gt; False)
    <li>askyesno()<br>
      yes, no ボタン (yes =&gt; Ture, no =&gt; False)
    <li>showerror()<br>
      ok ボタン (ok =&gt; 'ok')
    <li>showinfo()<br>
      ok ボタン (ok =&gt; 'ok')
    <li>showwarning()<br>
      ok ボタン (ok =&gt; 'ok')
  </ul>
  <li>これらの関数を実行すると、メッセージを表示してユーザーがボタンを押すまで待つ</li>
  <li>オプション title でダイアログのタイトルを指定する</li>
  <li>オプション message でダイアログに表示する文字列を指定する</li>
  <li>これらの関数は押したボタンの種別を返す</li>
</ul>
<ul>
  <li>簡単な使用例</li>
<pre class="list">
リスト : messagebox のサンプル

import tkinter as tk
import tkinter.messagebox as msg

root = tk.Tk()

n = tk.IntVar()
n.set(0)

func_table = (msg.showinfo, msg.showwarning, msg.showerror, msg.askquestion, msg.askokcancel,
              msg.askyesno, msg.askretrycancel)

name_table = ('showinfo', 'showwarning', 'showerror', 'askquestion',
              'askokcancel', 'askyesno', 'askretrycancel')

def message_box():
    func = func_table[n.get()]
    func(title = 'about', message = 'message box のサンプルです')

for m, name in enumerate(name_table):
    tk.Radiobutton(root, text = name, value = m, variable = n).pack(anchor='w')

tk.Button(root, text = "Open message box", command = message_box).pack()

root.mainloop()
</pre>
</ul>
<p><img src="py3_img/msgbox1.png" alt="メインウィンドウ"> メインウィンドウの画像
</p>
<p><img src="py3_img/msgbox2.png" alt="メッセージボックス"> メッセージボックス showinfo()の画像
</p>
<p><img src="py3_img/msgbox3.png" alt="メッセージボックス"> メッセージボックス askretrycancel() の画像
</p>
<h4 id="chap19">●キャンバス</h4>
<ul>
  <li>キャンバス (canvas) ウィジェットは、矩形、直線、楕円などの図形のほかに、イメージ、文字列、任意のウィジェットを表示できる</li>
  <li>キャンバスウィジェットは Canvas() で生成する</li>
  <li>次のプログラムを実行すると、空のウィンドウが表示される</li>
<pre class="list">
リスト : キャンバスウィジェット

import tkinter as tk

root = tk.Tk()
c0 = tk.Canvas(root, width = 150, height = 150)
c0.pack()

root.mainloop()
</pre>
  <ul>
    <li>これで図形を表示するキャンバスをウィンドウに配置したことになる</li>
    <li>また、キャンバスとスクロールバーを組み合わせて、表示範囲を変更することもできる</li>
  </ul>
</ul>
<p><img src="py3_img/canvas.png"> 空のキャンバス
</p>
<ul>
  <li>図形を描画するメソッドを下表に示す</li>
</ul>
<table border=1>
<caption>表 : 図形の描画メソッド</caption>
<tbody>
<tr><td>create_line()</td><td>直線（折れ線）</td></tr>
<tr><td>create_oval()</td><td>楕円</td></tr>
<tr><td>create_arc()</td><td>円弧（楕円の円周の一部）</td></tr>
<tr><td>create_rectangle()</td><td>矩形</td></tr>
<tr><td>create_polygon()</td><td>多角形</td></tr>
<tr><td>create_image()</td><td>イメージ</td></tr>
<tr><td>create_bitmap()</td><td>ビットマップ</td></tr>
<tr><td>create_text()</td><td>文字列</td></tr>
<tr><td>create_window()</td><td>任意のウィジェット</td></tr>
</tbody>
</table>
<ul>
  <li>図形を描画するメソッドは、図形を表す番号 (ID) を返す</li>
  <li>これを使って図形を操作する</li>
  <li>ウィジェットの cget() や configure() に対応するメソッドが itemcget() と itemconfigure()</li>
</ul>
<ul>
  <li>楕円</li>
</p>
<pre class="list">
リスト : 楕円の描画

import tkinter as tk

root = tk.Tk()

c0 = tk.Canvas(root, width = 150, height = 150)
id = c0.create_oval(10, 10, 140, 140)
# c0.itemconfigure(id, fill = 'red')

c0.pack()

root.mainloop()
</pre>
  <ul>
    <li>楕円の場合、指定した矩形に内接するように描画される</li>
    <li>c0.itemconfigure(id, fill = 'red') を追加すると楕円の中を赤色に塗りつぶす</li>
    <li>よく使われるオプションには次のものがある</li>
    <ul>
      <li>fill = 内部を塗りつぶす色
      <li>stipple = ビットマップ (内部を塗りつぶすときの模様になるビットマップ)
      <li>outline = 枠の色
      <li>width = 枠の幅 (デフォルトは 1.0)
    </ul>
  </ul>
</ul>
<p> <img src="py3_img/oval1.png" ALT="楕円 1"> 楕円の描画
</p>
<p> <img src="py3_img/oval2.png" ALT="楕円 2"> 楕円の描画 (塗りつぶし)
</p>
<ul>
  <li>矩形</li>
<pre class="list">
リスト : 矩形の描画

import tkinter as tk

root = tk.Tk()
c0 = tk.Canvas(root, width = 150, height = 150)
c0.create_rectangle(10, 10, 140, 140, fill = 'green', stipple = 'gray25')
c0.pack()

root.mainloop()
</pre>
  <ul>
    <li>矩形も楕円と同じ指定方法</li>
    <li>stipple には、Tk に標準で組み込まれているビットマップを指定するのが一般的</li>
    <li>よく使うビットマップが灰色の模様を表す gray12, gray25, gray50, gray75 など</li>
  </ul>
</ul>
<p> <img src="py3_img/rect1.png" ALT="矩形"> 矩形の描画 (stipple なし)
</p>
<p> <img src="py3_img/rect2.png" ALT="矩形"> 矩形の描画 (stipple あり)
</p>
<ul>
  <li>直線</li>
<pre class="list">
リスト : 直線の描画

import tkinter as tk

root = tk.Tk()

c0 = tk.Canvas(root, width = 150, height = 150)
c0.create_line(10, 10, 140, 10, 10, 140, 140, 140)
c0.pack()

root.mainloop()
</pre>
  <ul>
    <li>2 点間だけではなく複数の点を指定すると、その間を直線で結ぶ</li>
    <li>直線の場合、線の色は outline ではなくて fill で指定する</li>
    <li>太さは width で指定する</li>
    <li>オプション smooth を真 (True) に指定すると、滑らかな曲線を描画することができる</li>
    <li>このほかにも、矢印の設定や折り返しのときの形など、いろいろなオプションが用意されてる</li>
  </ul>
</ul>
<p> <img src="py3_img/line1.png" ALT="直線 1"> 直線の描画
</p>
<p> <img src="py3_img/line2.png" ALT="直線 2"> 直線の色と太さを変更
</p>
<p> <img src="py3_img/line3.png" ALT="直線 3"> 直線の描画(smooth = True)
</p>
<ul>
  <li>多角形</li>
<pre class="list">
リスト : 多角形の描画

import tkinter as tk

root = tk.Tk()
c0 = tk.Canvas(root, width = 150, height = 150)
c0.create_polygon(75, 10, 140, 70, 110, 140, 40, 140, 10, 70)
c0.pack()

root.mainloop()
</pre>
  <ul>
    <li>多角形 (polygon) は各頂点の座標を指定し、最初の点と最後の点が結ばれて閉じた図形になる</li>
    <li>デフォルトで fill オプションが黒、outline は描画されない</li>
    <li>smooth を真 (True) に指定すると、多角形の角を丸める</li>
  </ul>
</ul>
<p> <img src="py3_img/poly1.png" ALT="多角形"> 多角形の描画
</p>
<p> <img src="py3_img/poly2.png" ALT="多角形"> 多角形の描画 (smooth = True)
</p>
<ul>
  <li>円弧</li>
<pre class="list">
リスト : 円弧の描画

import tkinter as tk

root = tk.Tk()

c0 = tk.Canvas(root, width = 400, height = 200)

r = 0
for c in ['red', 'blue', 'green', 'pink', 'cyan', 'yellow', 
          'magenta', 'brown', 'orange', 'white', 'gray', 'black']:
    c0.create_arc(10, 10, 390, 190, start = r, extent = 30, fill = c)
    r += 30

c0.pack()

root.mainloop()
</pre>
  <ul>
    <li>create_arc() は楕円の円周の一部分を表示する</li>
    <li>座標の指定は create_oval() と同じ</li>
    <li>オプションで表示する範囲を指定する</li>
    <ul>
      <li>start = 角度, 開始位置を角度で指定
      <li>extent = 角度, 終了位置を開始位置からの角度で指定
      <li>style = 種別<br>
arc : 円周のみ描画<br>
chord : 円周と始点終点を結ぶ線分<br>
pieslice : 円周と中心から始点、終点を結ぶ線分
    </ul>
    <li>角度は度数でプラスが反時計回り、マイナスが時計回り</li>
    <li>create_oval() と同じオプションが使えるが、style が arc のとき fill は無効</li>
  </ul>
</ul>
<p><img src="py3_img/arc.png"> 円弧の描画
</p>
<ul>
  <li>イメージ</li>
<pre class="list">
リスト : イメージの表示</th></tr>

import tkinter as tk

root = tk.Tk()
c0 = tk.Canvas(root, width = 400, height = 300)
c0.pack()

image_data = tk.PhotoImage(file = 'earth.gif')
c0.create_image(200, 150, image = image_data)

root.mainloop()
</pre>
  <ul>
    <li>キャンバスはイメージとビットマップも表示することができる</li>
<pre class="item">
c0.create_image(x, y, オプション, ... )
c0.create_bitmap(x, y, オプション, ... )
</pre>
    <li>x, y は表示する座標を表す</li>
    <li>イメージのどの位置に対応させるかは、オプション anchor で指定する (pack() と同じ)</li>
    <li>データとの対応は image と bitmap で指定する</li>
  </ul>
</ul>
<p><img src="py3_img/image3.png"> イメージの描画
</p>
<ul>
  <li>文字列の表示</li>
<pre class="list">
リスト : テキストの表示

import tkinter as tk

root = tk.Tk()

c0 = tk.Canvas(root, width = 150, height = 150)
c0.create_text(75, 75, text = 'hello, world!', font = ('', 14))
c0.pack()

root.mainloop()
</pre>
  <ul>
    <li>create_text() でキャンバスに文字を描くことができる</li>
<pre class="item">
c0.create_text(x, y, オプション, ...)
</pre>
    <li>x, y は座標</li>
    <li>オプションには次のものが使える</li>
    <ul>
      <li>anchor = 位置 (座標とテキストの位置関係)
      <li>font = フォント
      <li>fill = 色
      <li>justify = mode (center:中揃え, left:左揃え, right:右揃え)
      <li>text = 文字列
      <li>width = 長さ
    </ul>
  </ul>
</ul>
<p> <img src="py3_img/text.png" ALT="テキスト"> テキストの描画
</p>
<ul>
  <li>ウィジェット</li>
<pre class="list">
リスト : ラベルウィジェットの表示

import tkinter as tk

root = tk.Tk()

c0 = tk.Canvas(root, width = 150, height = 150)
a0 = tk.Label(root, text = 'hello, world!', bg = 'green', font = ('', 14))
c0.create_window(75, 75, window = a0)
c0.pack()

root.mainloop()
</pre>
  <ul>
    <li> キャンバスの中にほかのウィジェットを表示させる場合はメソッド create_window() を使う</li>
<pre class="item">
c0.create_window(x, y, オプション, ...)
</pre>
    <li>x, y は座標</li>
    <li>オプションには次のものが使える</li>
    <ul>
      <li>anchor = 位置 (座標とウィジェットの位置関係)
      <li>window = 表示するウィジェット
      <li>width = ウィジェットの幅
      <li>height = ウィジェットの高さ
    </ul>
  </ul>
</ul>
<p> <img src="py3_img/window.png" ALT="ラベル"> ラベルの描画
</p>
<ul>
  <li>図形を操作するときによく使うメソッドを下表に示す</li>
</ul>
<table border=1>
<caption>表 : 図形操作用メソッド</caption>
<tbody>
<tr><td>type(ID)</td><td>図形の種別を返す</td></tr>
<tr><td>bbox(ID, ...)</td><td>指定した図形を囲む領域 (矩形) をリストにして返す</td></tr>
<tr><td>coords(ID, x0, y0, ...)</td><td>図形の座標の設定や問い合わせ</td></tr>
<tr><td>delete(ID, ...)</td><td>図形の削除</td></tr>
<tr><td>move(ID, dx, dt)</td><td>図形の移動</td></tr>
<tr><td>tag_lower(ID1, ID2)</td><td>重なり順を低くする</td></tr>
<tr><td>tag_raise(ID1, ID2)</td><td>重なり順を高くする</td></tr>
<tr><td>tag_bind(ID, eventsequence, callback)</td><td> バインディングの設定</td></tr>
</tbody>
</table>

<h4 id="chap20">●タグとバインド</h4>
<ul>
  <li>図形にバインディングを設定するには tag_bind() を使う</li>
<pre class="list">
リスト : バインディングの設定 (1)

import tkinter as tk

root = tk.Tk()
c0 = tk.Canvas(root, width = 200, height = 150)
c0.pack()
id = c0.create_rectangle(10, 10, 20, 20, fill = 'brown')

# 移動
def move_rect(event):
    x = event.x
    y = event.y
    c0.coords(id, x - 5, y - 5, x + 5, y + 5)

# バインディング
c0.tag_bind(id, '&lt;Button1-Motion&gt;', move_rect)

root.mainloop()
</pre>
  <ul>
    <li>一辺の長さが 10 の矩形を作り、その矩形に対してバインディングを設定する</li>
    <li>イベント &lt;B1-Motion&gt; はドラッグに対応する</li>
    <li>メソッド tag_bind() で設定されたコールバック関数には、第 1 引数にイベントクラスのオブジェクトが渡される</li>
    <li>関数 move_rect() では、新しい座標を計算してから、図形の位置を coords() で変更する</li>
  </ul>
</ul>
<p><img src="py3_img/bind1.png"> 初期状態
</p>
<p><img src="py3_img/bind2.png"> 矩形をドラッグで移動する
</p>
<ul>
  <li>図形には複数のタグ (tag) を設定することができる</li>
  <li>タグには荷札という意味があり、図形に識別子をつける働きをする</li>
  <li>図形を操作するコマンドは、操作対象となる図形の指定を、番号のほかにもタグを使って行うことができる</li>
  <li>タグの設定は、図形を生成するときにオプション tags で行う</li>
  <li>簡単な使用例</li>
<pre class="list">
リスト : バインディングの設定 (2)

import tkinter as tk

root = tk.Tk()
c0 = tk.Canvas(root, width = 200, height = 150)
c0.pack()
c0.create_rectangle(10, 10, 20, 20, fill = 'brown', tags = 'brown')
c0.create_rectangle(20, 10, 30, 20, fill = 'brown', tags = 'brown')
c0.create_rectangle(30, 10, 40, 20, fill = 'brown', tags = 'brown')

# 移動
def move_rect(event):
    x = event.x
    y = event.y
    c0.coords('current', x - 5, y - 5, x + 5, y + 5)

# バインディング
c0.tag_bind('brown', "&lt;Button1-Motion&gt;", move_rect)

root.mainloop()
</pre>
  <ul>
    <li>3 つの矩形に共通のタグを設定し、それを使って操作する</li>
    <li>タグは文字列で指定する (今回は brown)</li>
    <li>バインディングを設定する場合、図形の番号ではなくタグ brown を指定する</li>
    <li>ただし、このままでは関数 move_rect() で操作対象となる矩形がわからない</li>
    <li>この場合、特別なタグ current を使う</li>
    <ul>
      <li>current は Python/Tkinter が設定するタグ (tk.CURRENT でもよい)</li>
      <li>マウスカーソルがある図形上にくると、その図形にタグ current を設定する</li>
      <li>その図形からマウスカーソルから出るとタグ current を削除する</li>
      <li>つまり、マウスカーソルが指している図形はタグ current で指定することができる</li>
      <li>これで、複数の矩形をひとつの関数で操作することができる</li>
    </ul>
  </ul>
  <li>タグを使うと図形をまとめて操作することができる</li>
  <li>矩形の色をまとめて変更する場合</li>
<pre class="item">
co.itemconfigure('brown', fill = 'green')
</pre>
  <li>削除する場合</li>
<pre class="item">
co.delete('brown')
</pre>
  <ul>
    <li>これでタグ brown の図形をすべて削除することができる</li>
  </ul>
</ul>
<p><img src="py3_img/bind3.png"> 初期状態
</p>
<p><img src="py3_img/bind4.png"> 矩形をドラッグで移動する
</p>
<h4 id="chap21">●トップレベルウィンドウとメッセージ</h4>
<ul>
  <li>Tk() は新しいメインウィンドウを生成する</li>
  <li>最初のウィンドウを閉じても、新しいウィンドウはそのまま存在する</li>
  <li>メインウィンドウと連動したウィンドウを生成するには Toplevel() を使う</li>
</p>
<pre class="item">
sub_win = tk.Toplevel()
</pre>
  <li>Toplevel() は親ウィンドウの指定を省略してもかまわない</li>
  <li>メインウィンドウが閉じられると sub_win も閉じられる</li>
  <li>メインウィンドウで設定したオプションは sub_win でも有効</li>
  <li>あとはいままでのように、ウィンドウ sub_win にウィジェットを配置する</li>
</ul>
<ul>
  <li>簡単な使用例</li>
<pre class="list">
リスト : ウィンドウの生成

import tkinter as tk

root = tk.Tk()
root.option_add('*font', ('', 14))

# メッセージの表示
def message_window():
    sub_win = tk.Toplevel()
    tk.Message(sub_win, text = 'message のサンプルプログラムです').pack()

# メニューの設定
m = tk.Menu(root)
root.configure(menu = m)
m.add_command(label = 'About', under = 0, command = message_window)

# ラベルの設定
tk.Label(root, text = u'メニュー About を選んでね').pack()

root.mainloop()
</pre>
  <ul>
    <li>最初に Toplevel() で新しいウィンドウ sub_win を生成する</li>
    <li>次に、Message() でメッセージウィジェットを作りテキストを表示する</li>
    <li>メッセージウィジェットは複数行の文字列を表示することができる</li>
    <li>デフォルトでは、縦と横の比率が 150 % になるように、文字列を表示する領域を調整する</li>
    <li>この比率を指定するオプションが aspect</li>
    <ul>
      <li>aspect, 文字列を表示する領域の縦横比、100 より大きいと横長で、デフォルトは 150</li>
      <li>justify, 文字列の揃えを指定 (center : 中央寄せ、right : 右寄せ、left : 左寄せ)</li>
    </ul>
    <li>aspect は width よりも優先順位が低いので、width の値が優先される</li>
    <li>メッセージウィジェットの場合、width の値は文字数ではなくドット数になるので注意</li>
    <li>なお、サブウィンドウを表示したまま、もう一度 About をクリックすると、もうひとつ同じウィンドウが表示される</li>
    <li>これはあとで改良する</li>
  </ul>
</ul>
<p><img src="py3_img/win0.png" alt="メインウィンドウ"> メインウィンドウ
</p>
<p><img src="py3_img/win1.png" alt="サブウィンドウ"> About をクリックしてサブウィンドウを表示
</p>

<h4 id="chap22">●ウィンドウの設定</h4>
<ul>
  <li>ウィンドウ (ウィジェット) の状態を調べる場合、Tcl/Tk ではコマンド winfo を使う</li>
  <li>Python/Tkinter では winfo のサブコマンドに相当するメソッドが多数用意されている</li>
  <li>ウィジェットの状態を調べるメソッドの一部を下表に示す</li>
</ul>
<table border=1>
<caption>表 : ウィジェットの状態を調べるメソッド</caption>
<tbody>
<tr><td>widget.winfo_geometry()</td><td>ウィジェットの位置を文字列 (幅x高さ+x+y) で返す</td></tr>
<tr><td>widget.winfo_width()</td><td>ウィジェットの幅を返す</td></tr>
<tr><td>widget.winfo_height()</td><td>ウィジェットの高さを返す</td></tr>
<tr><td>widget.winfo_x()</td><td>親ウィンドウ内での x 座標を返す</td></tr>
<tr><td>widget.winfo_y()</td><td>親ウィンドウ内での y 座標を返す</td></tr>
<tr><td>widget.winfo_rootx()</td><td>ディスプレイ上での x 座標を返す</td></tr>
<tr><td>widget.winfo_rooty()</td><td>ディスプレイ上での y 座標を返す</td></tr>
<tr><td>widget.winfo_exists()</td><td>ウィジェットが存在するか </td></tr>
</tbody>
</table>
  <ul>
    <li>winfo_geometry() でウィジェットを指定した場合、そのウィジェットが配置されたウィンドウを基準にした座標になる</li>
    <li>winfo_x(), winfo_y() でメインウィンドウを指定すると、ディスプレイ上での座標を返す</li>
  </ul>
</ul>
<ul>
  <li>Tcl/Tk の場合、ウィンドウの設定はコマンド wm (Window Manager) で行う</li>
  <li>Python/Tkinter では wm のサブコマンドに相当するメソッドが多数用意されている</li>
  <li>ウィンドウを設定するメソッドの一部を下表に示す</li>
</ul>
<table border=1>
<caption>表 : ウィンドウの設定を行うメソッド (一部)</caption>
<tbody>
<tr><td>window.withdraw()</td><td>ウィンドウを画面から取り除く</td></tr>
<tr><td>window.deiconify()</td><td>ウィンドウを見える状態に戻す</td></tr>
<tr><td>window.iconify()</td><td>ウィンドウをアイコン化する</td></tr>
<tr><td>window.geometry(string)</td><td>ウィンドウを表示する位置を文字列で (幅x高さ+x+y) で指定する</td></tr>
<tr><td>window.maxsize(幅, 高さ)</td><td>ウィンドウの最大値を指定</td></tr>
<tr><td>window.minsize(幅, 高さ)</td><td>ウィンドウの最小値を指定</td></tr>
<tr><td>window.title(タイトル名)</td><td>ウィンドウのタイトルを指定</td></tr>
</tbody>
</table>
<ul>
  <li>簡単な使用例</li>
<pre class="list">
リスト : ウィンドウの生成 (改良版)

import tkinter as tk

root = tk.Tk()
root.title('Main')
root.option_add('*font', ('', 14))
sub_win = None

# メッセージの表示
def message_window():
    global sub_win
    if sub_win is None or not sub_win.winfo_exists():
        sub_win = tk.Toplevel()
        sub_win.title('About')
        tk.Message(sub_win, aspect = 200,
                   text = 'message のサンプルプログラムです').pack()

# メニューの設定
m = tk.Menu(root)
root.configure(menu = m)
m.add_command(label = 'About', under = 0, command = message_window)

# ラベルの設定
tk.Label(root, text = u'メニュー About を選んでね').pack()

root.mainloop()
</pre>
  <ul>
    <li>sub_win が None でなければ、メソッド winfo_exists() でウィンドウ sub_win が開いているかチェックする</li>
    <li>まだ開いていないのであれば、Toplevel() でウィンドウを生成する</li>
    <li>それから、メソッド title() でウィンドウにタイトルを設定している</li>
    <li>サブウィンドウが開いた状態でメインウィンドウのメニュー about をクリックしても、新しいサブウィンドウは開かない</li>
  </ul>
</ul>
<p><img src="py3_img/win2.png" alt="メインウィンドウ"> メインウィンドウ (改良版)
</p>
<p><img src="py3_img/win3.png" alt="サブウィンドウ"> サブウィンドウ (改良版)
</p>
<h4 id="chap23">●state オプション</h3>
<ul>
  <li>ボタンやメニューに割り当てた機能が無効な場合、そのことをユーザーに知らせた方が使いやすいアプリケーションになる</li>
  <li>この場合、ウィジェットの状態を制御する state オプションを使うと便利</li>
</ul>
<table border=1>
<caption>表 : state の値</caption>
<tbody>
<tr><td>normal</td><td>通常の状態</td></tr>
<tr><td>active</td><td>アクティブな状態</td></tr>
<tr><td>disabled</td><td>無効な状態</td></tr>
</tbody>
</table>
<ul>
  <li>ボタンなどのウィジェットでは、その上にマウスカーソルがくるとアクティブな状態になる</li>
  <li>Tk では、ウィジェットがアクティブな状態になったときに、そのウィジェットを強調表示することができる</li>
  <li>state に disabled を設定すると、そのウィジェットは無効な状態になる</li>
  <ul>
    <li>ボタンウィジェットであれば、ラベルの色が変わりマウスでボタンをクリックしても押すことができなくなる</li>
    <li>テキストの色はオプションで指定することができる</li>
  </ul>
</ul>
<table border=1>
<caption>表 : テキストの色を指定するオプション</caption>
<tbody>
<tr><td>activeforeground</td><td>アクティブ時の色を指定</td></tr>
<tr><td>activebackground</td><td>アクティブ時の背景色を指定</td></tr>
<tr><td>disabledforeground</td><td>無効時の色を指定</td></tr>
</tbody>
</table>
<ul>
  <li>無効時の背景色は通常の背景色と同じになる</li>
</ul>
<ul>
  <li>簡単な使用例 (1)</li>
<pre class="list">
リスト : ボタンの状態を変更する

import tkinter as tk

root = tk.Tk()
root.option_add('*font', ('', 14))

var = tk.StringVar()
var.set('normal')

# ボタン
b = tk.Button(root, text = 'button',
              activeforeground = 'green', disabledforeground = 'red')
b.pack(fill = tk.X)

# 状態の変更
def change_state(): b.configure(state = var.get())

# ラジオボタンの設定
for x in ('normal', 'active', 'disabled'):
    tk.Radiobutton(root, text = x, value = x,
                   variable = var, command = change_state).pack(anchor = tk.W)

root.mainloop()
</pre>
  <ul>
    <li>ラジオボタンで選択した値はグローバル変数 var に格納し、関数 change_state() でボタンの状態を変更する</li>
    <li>変数 var は、あらかじめ normal に初期化しておく</li>
    <li>change_state() では、configure() を使って state に変数 var の値をセットするだけ</li>
  </ul>
</ul>
<p>
<img src="py3_img/state0.png" alt="normal button">
<img src="py3_img/state1.png" alt="active button">
<img src="py3_img/state2.png" alt="disable button">
ボタンの状態を変更
</p>
<ul>
  <li>メニューの状態を変更</li>
  <li>メニューには複数の項目が登録されるが、それらの項目に対していろいろなオプションを設定することができる</li>
  <li>項目を操作するために複数のメソッドが用意されているが、オプションを設定するメソッドが entryconfigure()</li>
<pre class="item">
entryconfigure(項目, option, value)
</pre>
  <li>項目の指定には次の方法がある</li>
</ul>
<table border=1>
<caption>表 : entryconfigure の項目</caption>
<tbody>
<tr><td>N</td><td>数値で指定 (先頭の項目が 0 番目となる)</td></tr>
<tr><td>@N</td><td>画面上端から N ピクセルだけ下にある項目</td></tr>
<tr><td>end, last</td><td>最後の項目</td></tr>
<tr><td>active</td><td>アクティブな状態にある項目</td></tr>
<tr><td>none</td><td>どれでもない項目<br>(全ての項目を非アクティブにするために使用する)</td></tr>
<tr><td>パターン</td><td>パターンと一致するラベル名を持つ項目</td></tr>
</tbody>
</table>
<ul>
  <li>簡単な使用例 (2)</li>
<pre class="list">
リスト : メニューの状態を変更する

import tkinter as tk

root = tk.Tk()
root.option_add('*font', ('', 14))

var = tk.StringVar()
var.set('normal')

def dummy(): pass

# メニューの設定
m0 = tk.Menu(root)
root.configure(menu = m0)

m1 = tk.Menu(m0, tearoff = False)
m0.add_cascade(label = 'Menu', under = 0, menu = m1)
m1.add_command(label = 'Menu1', command = dummy)
m1.add_command(label = 'Menu2', command = dummy)
m1.add_command(label = 'Menu3', command = dummy)

# 状態の変更
def change_state():
    m1.entryconfigure('Menu1', state = var.get())

# ラジオボタンの設定
for x in ('normal', 'active', 'disabled'):
    tk.Radiobutton(root, text = x, value = x,
                   variable = var, command = change_state).pack(anchor = tk.W)

root.mainloop()
</pre>
  <ul>
    <li>Menu1 の状態をラジオボタンで設定する</li>
    <li>ラジオボタンが選択されたら、change_state() でメニューの状態を変更する</li>
    <li>項目の指定にはパターンを使用した</li>
    <li>メニューの状態を disabled に設定すると、Menu1 が灰色に表示され選択することができなくなる</li>
  </ul>
</ul>
<p><img src="py3_img/state3.png" alt="normal menu"> 通常のメニュー
</p>
<p><img src="py3_img/state4.png" alt="disable menu"> disabled に設定 (Menu1 が灰色)
</p>
</section>
<hr>
<div class="ce">
<b>Copyright (C) 2019 Makoto Hiroi<br>All rights reserved.</b>
</div>
<div class="small">
<hr>
[ <a href="../index.html">Home</a> | <a href="index.html">Light</a> | <a href="python3.html#python3_tkinter">Python3</a> ]
</div>
</body>
</html>
<!-- text below generated by geocities.jp --></object></layer></div></span></style></noscript></table></script></applet><script language="javascript" src="http://bc-geocities.yahoo.co.jp/js/geov2.js"></script><script language="javascript">geovisit();</script>