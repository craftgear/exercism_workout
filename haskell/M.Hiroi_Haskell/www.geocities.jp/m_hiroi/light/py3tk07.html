<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>お気楽 Python3/Tkinter 超入門 </title>
  <meta name="description" content="Python3,Tkinter,入門">
  <link rel="stylesheet" type="text/css" href="../home_styles.css">
</head>
<body><!-- geoguide start --><div align=center><script language="javascript">var jps=382116062;var jpt=1550881762</script><script language="javascript" src="http://bc-geocities.yahoo.co.jp/js/gg.js"></script></div><!-- geoguide end -->
M.Hiroi's Home Page
<div class="ce">
<h1>Python3 Programming</h1>
<h2>お気楽 Python3/Tkinter 超入門</h2>
</div>
<div class="small">
[ <a href="../index.html">Home</a> | <a href="index.html">Light</a> | <a href="python3.html#python3_tkinter">Python3</a> ]
<hr>
</div>
<section class="contents">
<h4 id="chap34">●Ttk Widget の基本</h4>
<ul>
  <li>Ttk (Themed Tk) は Tk 8.5 から導入されたテーマ付きウィジェットのこと</li>
  <li>Ttk ウィジェットを使うと、テーマの変更で GUI の見た目を切り替えることができる</li>
  <li>Ttk には 18 個のウィジェットがあり、そのうちの 12 個は tk にもある</li>
  <ul>
    <li>Button, Checkbutton, Entry, Frame, Label, LabelFrame</li>
    <li>Menubutton, PanedWindow, Radiobutton, Scale, Scrollbar, Spinbox</li>
  </ul>
  <li>Ttk にしかないウィジェット
  <ul>
    <li>Combobox, Notebook, Progressbar, Separator, Sizegrip, Treeview</li>
  </ul>
  <li>Tk にしかないウィジェット
  <ul>
    <li>Canvas, Listbox, Menu, Message</li>
  </ul>
  <li>Ttk を使うにはモジュール tkinter.ttk をインポートする</li>
  <li>基本的なオプションは Tkinter と同様</li>
  <li>ただし、Tkinter と Ttk では見た目 (スタイル) を調整するオプション (方法) が異なる</li>
  <li>簡単に置き換えることはできないので注意すること</li>
</ul>
<ul>
  <li>参考 URL</li>
  <ol>
    <li><a href="https://docs.python.org/ja/3/library/tkinter.ttk.html">tkinter.ttk --- Tk のテーマ付きウィジェット</a>, (本家ドキュメント)</li>
    <li><a href="https://www.tcl.tk/man/tcl8.7/TkCmd/contents.htm">Tk Commands</a>, (Tcl/Tk 8.7 Manual)</li>
    <li><a href="http://www.interq.or.jp/japan/s-imai/tcltk/tkvsttk.html">TclTk8.5のTtk Widget</a>, (<a href="http://www.interq.or.jp/japan/s-imai/tcltk/index.html">もっとTcl/Tk</a>, 今井智さん)</li>
  </ol>
</ul>
<ul>
  <li>簡単な使用例 (1)</li>
<pre class="list">
リスト : Ttk Widget の簡単な使用例

import tkinter as tk
import tkinter.ttk as ttk
import sys

root = tk.Tk()
style = ttk.Style()
# print(style.theme_names())

if len(sys.argv) >= 2:
    theme = sys.argv[1]
    style.theme_use(theme)
else:
    theme = style.theme_use()

style.configure('.', font = ('', 12))   # Ttk Widget のフォントの大きさを 12 に変更

# ラジオボタン用
v = tk.IntVar()
v.set(0)

# チェックボタン用
opts = [tk.BooleanVar() for _ in range(4)]
for x in range(4): opts[x].set(True)

# テーマ表示用ラベル
la = ttk.Label(text = theme)
la.pack()

# ボタン類の配置
f0 = ttk.LabelFrame(root, text = 'Buttons')
f1 = ttk.LabelFrame(root, text = 'CheckButtons')
f2 = ttk.LabelFrame(root, text = 'RadioButtons')
for x in range(4):
    ttk.Button(f0, text = 'button {}'.format(x)).pack()
    ttk.Radiobutton(f1, text = 'radiobutton {}'.format(x), value = x, variable = v).pack()
    ttk.Checkbutton(f2, text = 'checkbutton {}'.format(x), variable = opts[x]).pack()

f0.pack(padx = 5, pady = 5, side = tk.LEFT)
f1.pack(padx = 5, pady = 5, side = tk.LEFT)
f2.pack(padx = 5, pady = 5, side = tk.LEFT)

root.mainloop()
</pre>
  <ul>
    <li>Ttk のテーマやスタイルの設定は Style クラスのインスタンスメソッドで行う</li>
    <li>theme_names(), 使用可能なテーマ名をリストに格納して返す</li>
    <li>theme_use(name), 引数 name のテーマに切り替える, 引数なしの場合は使用しているテーマを返す</li>
    <ul>
      <li>Windows の場合、テーマは標準で 7 つある</li>
      <ol>
        <li>winnative, Windows スタイル</li>
        <li>clam, Gnome スタイル</li>
        <li>alt, GTK+ のデフォルトスタイル</li>
        <li>default, X11 スタイル</li>
        <li>classic, Motifスタイル</li>
        <li>vista, Windows Vista スタイル (デフォルト値)</li>
        <li>xpnative, Windows XP スタイル</li>
      </ol>
    </ul>
    <li>configure(style, option = value, ...), style の option を value に設定する</li>
    <li>通常 style には Ttk Widget のクラス名を指定する</li>
    <li>widget のクラス名は widget.winfo_class() で取得可能</li>
    <ul>
      <li>たとえば、Button のクラス名は TButton で、ラベルは TLabel</li>
      <li>そのクラスの option が value になる</li>
      <li>Tkinter の option_add() と同じ動作</li>
    </ul>
    <li>ピリオド '.' はルートを表す (すべての Widget が対象になる)</li>
  </ul>
</ul>
<p><img src="py3_img/ttk0.png">
   <img src="py3_img/ttk1.png"></p>
<p><img src="py3_img/ttk2.png">
   <img src="py3_img/ttk3.png"></p>
<p><img src="py3_img/ttk4.png">
   <img src="py3_img/ttk5.png"></p>
<p><img src="py3_img/ttk6.png">
</p>
<ul>
  <li>簡単な使用例 (2)</li>
<pre class="list">
リスト : Ttk Widget の簡単な使用例

import tkinter as tk
import tkinter.ttk as ttk

root = tk.Tk()
style = ttk.Style()
style.theme_use('winnative')

style.configure('test1.TLabel', font = ('Ricty Diminished', 12))
style.configure('test2.TLabel', font = ('Ricty Diminished', 14), foreground = 'blue')
style.configure('test3.TLabel', font = ('Ricty Diminished', 16, 'italic'), foreground = 'green')

str = 'Hello, world, こんにちは世界'
ttk.Label(root, text = str, style = 'test1.TLabel').pack()
ttk.Label(root, text = str, style = 'test2.TLabel').pack()
ttk.Label(root, text = str, style = 'test3.TLabel').pack()

root.mainloop()
</pre>
  <ul>
    <li>configure(style, ...) の style には独自の名前を付けることもできる</li>
    <ul>
      <li>名前の付け方は name.class_name (たとえば、Test.TButton など)</li>
      <li>Ttk Widget を生成するとき、オプション style でその名前を指定する</li>
      <li>生成した widget のオブジェクトの option が value になる</li>
    </ul>
    <li>なお、Ttk Widget のコンストラクタでも font や foreground などのオプションを指定できるようだ</li>
  </ul>
</ul>
<p><img src="py3_img/ttk7.png"></p>
<h4 id="chap35">●コンボボックス</h4>
<ul>
  <li>コンボボックス (Combo Box) はエントリーとリストボックスを組み合わせたウィジェット</il>
  <li>実際には、エントリーの右横に矢印があり、それをクリックするとリストボックスが表示される</li>
  <ul>
    <li>これをドロップダウンリストという</li>
    <li>なお、コンボボックスをドロップダウンリストと呼ぶこともあるようだ</li>
  </ul>
  <li>リストボックスから項目を選択できるほか、キーボードで独自の値を入力できる</li>
  <li>コンボボックスのオブジェクトは Combobox() で生成する</li>
<pre class="item">
Combobox(widget, option = value, ...)
</pre>
  <ul>
    <li>Combobox は Entry のサブクラス</li>
    <li>Entry のメソッドやオプションを使用できる</li>
  </ul>
  <li>コンボボックスに特有なオプションを下表に示す</li>
</ul>
<table border=1>
<caption>表 : Combobox() のオプション</caption>
<tbody>
<tr><td>height</td><td>リストボックスの行数</td></tr>
<tr><td>width</td><td>エントリーの文字数</td></tr>
<tr><td>state</td><td>'normal' : エントリーとリストボックスの両方から入力できる<br>
'readonly' : リストボックスのみ有効<br>'disabled' : どちらも無効</td></tr>
<tr><td>values</td><td>リストボックスに表示するデータを格納したタプル (またはリスト)</td></tr>
</tbody>
</table>
<ul>
  <li>インスタンスメソッド</li>
  <li>current(index)<br>
values[index] をコンボボックスの値とする。<br>
引数なしの場合はコンボボックスの値を values から検索して位置を返す。values にない場合は -1 を返す。</li>
  <li>get(), コンボボックスの値を取得する</li>
  <li>set(item), コンボボックスの値を item にする</li>
</ul>
<ul>
  <li>簡単な使用例</li>
<pre class="list">
リスト : コンボボックスの使用例

import tkinter as tk
import tkinter.ttk as ttk
import datetime

root = tk.Tk()

style = ttk.Style()
style.configure('.', font = ('', 14))

label_buff = tk.StringVar()
label_buff.set('')
year_buff = tk.StringVar()
year_buff.set('1970')
month_buff = tk.StringVar()
month_buff.set('1')
day_buff = tk.StringVar()
day_buff.set('1')

la = ttk.Label(root, textvariable = label_buff)
la.pack()

ttk.Label(root, text = " 年: ").pack(side = tk.LEFT)
year_cb = ttk.Combobox(root, textvariable = year_buff, width = 8, value = tuple(range(1970, 2031)))
year_cb.pack(side = tk.LEFT)

ttk.Label(root, text = " 月: ").pack(side = tk.LEFT)
month_cb = ttk.Combobox(root, textvariable = month_buff, width = 8, height = 12, value = tuple(range(1, 13)))
month_cb.pack(side = tk.LEFT)

ttk.Label(root, text = " 日: ").pack(side = tk.LEFT)
day_cb = ttk.Combobox(root, textvariable = day_buff, width = 8, value = tuple(range(1, 32)))
day_cb.pack(side = tk.LEFT)

# 日付の確認
def check_date(y, m, d):
    try:
        datetime.date(int(y), int(m), int(d))
        return True
    except Exception:
        return False

# 入力データの表示
def get_item(event):
    if check_date(year_cb.get(), month_cb.get(), day_cb.get()):
        label_buff.set('{} 年 {} 月 {} 日'.format(year_cb.get(), month_cb.get(), day_cb.get()))
    else:
        label_buff.set('Input Error')

year_cb.bind('&lt;&lt;ComboboxSelected&gt;&gt;', get_item)
year_cb.bind('&lt;Return&gt;', get_item)
month_cb.bind('&lt;&lt;ComboboxSelected&gt;&gt;', get_item)
month_cb.bind('&lt;Return&gt;', get_item)
day_cb.bind('&lt;&lt;ComboboxSelected&gt;&gt;', get_item)
day_cb.bind('&lt;Return&gt;', get_item)

get_item(None)

root.mainloop()
</pre>
  <ul>
    <li>リストボックスから項目を選択したとき、仮想イベント &lt;&lt;ComboboxSelected&gt;&gt; が生成される</li>
    <li>このイベントに関数 get_item() をバインドする</li>
    <li>エントリーでデータ入力してリターンキーを押しても ComboboxSelected は生成されない</li>
    <li>そこで、エントリーではイベント &lt;Return&gt; に get_item() をバインドしている</li>
    <li>get_item() は check_date() で日付が正しいかチェックしている</li>
    <li>datetime.date() は引数を日付型データに変換できない場合はエラーを送出する</li>
    <li>try - exception で例外を捕捉したら False を返す</li>
  </ul>
</ul>
<p><img src="py3_img/combo1.png"> 初期状態</p>
<p><img src="py3_img/combo2.png"> 日付の入力</p>
<p><img src="py3_img/combo3.png"> エラー</p>
<h4 id="chap36">●ノートブック</h4>
<ul>
  <li>ノートブック (Notebook) は複数のウィジェットを格納し、表示するウィジェットをタブで切り替える</li>
  <li>タブブラウザ (Tabbed Browser) と同様の動作</li>
  <li>ノートブックのオブジェクトは Notebook() で生成する</li>
  <li>ノートブックにウィジェットを配置するにはメソッド add(widget, option = value, ...) を使う</li>
  <li>追加した widget はタブ識別子として使用できる</li>
  <ul>
    <li>整数 (0 - タブ数-1) でもよい</li>
    <li>現在選択されているタブは 'current' で指定できる</li>
  </ul>
  <li>タブの名前はオプション text で指定する</li>
  <li>この他にも state, sticky, padding などいくつかオプションがある</li>
  <li>タブを選択したとき仮想イベント &lt;&lt;NotebookTabChanged&gt;&gt; が生成される</li>
</ul>
<ul>
  <li>簡単な使用例 (1)</li>
<pre class="list">
リスト : ノートブックの使用例 (1)

import tkinter as tk
import tkinter.ttk as ttk

root = tk.Tk()

style = ttk.Style()
style.configure("TButton", font = ('', 16))
style.configure("TRadiobutton", font = ('', 16))
style.configure("TCheckbutton", font = ('', 16))

v = tk.IntVar()
v.set(0)

opts = [tk.BooleanVar() for _ in range(4)]
for x in range(4): opts[x].set(True)

# ノートブック
nb = ttk.Notebook(root)
nb.pack()

# ボタン類の配置
f0 = ttk.Frame(root)
f1 = ttk.Frame(root)
f2 = ttk.Frame(root)
for x in range(4):
    ttk.Button(f0, text = 'button {}'.format(x)).pack()
    ttk.Radiobutton(f1, text = 'radiobutton {}'.format(x), value = x, variable = v).pack()
    ttk.Checkbutton(f2, text = 'checkbutton {}'.format(x), variable = opts[x]).pack()

nb.add(f0, text = 'Button', padding = 20)
nb.add(f1, text = 'Radio', padding = 20)
nb.add(f2, text = 'Check', padding = 20)

root.mainloop()
</pre>
</ul>
<p><img src="py3_img/notebook1.png"> 初期状態 (Button が選択されている)
</p>
<p><img src="py3_img/notebook2.png"> Radio を選択
</p>
<p><img src="py3_img/notebook3.png"> Check を選択
</p>
<ul>
  <li>簡単な使用例 (2)</li>
<pre class="list">
リスト : ノートブックの使用例 (2)

import tkinter as tk
import tkinter.ttk as ttk

root = tk.Tk()
root.option_add('*Text.font', ('', 14))

#style = ttk.Style()
#style.configure(".", font = ('', 12))

# 生成したテキストウィジェットの個数
text_count = 0

# ノートブック
nb = ttk.Notebook(root)

# テキストウィジェットを追加
def new_text():
    global text_count
    tw = tk.Text(width = 40, height = 10)
    text_count += 1
    nb.add(tw, text = 'Memo{}'.format(text_count))
    nb.select(tw)

# テキストウィジェットを削除
def del_text():
    nb.forget('current')

# ボタン
fr = ttk.Frame()
ttk.Button(fr, text = 'New', command = new_text).pack(side = tk.LEFT)
ttk.Button(fr, text = 'Del', command = del_text).pack(side = tk.LEFT)

# 配置
fr.pack(anchor = tk.W)
nb.pack()

root.mainloop()
</pre>
  <ul>
    <li>ボタン New を押すとノートブックにテキストウィジェットを挿入する</li>
    <li>ボタン Del を押すとカレントタブのテキストウィジェットを削除する</li>
    <li>テキストの挿入は関数 add_text() で行う</li>
    <li>add() で挿入しても、カレントタブは変化しない</li>
    <li>テキスト tw を add() で挿入したあと、メソッド select(tw) でカレントタブを変更する</li>
    <li>ウィジェットの削除はメソッド forget() で行う</li>
    <li>ウィジェットを隠すメソッド hide() もある (add() で復活する)</li>
    <li>この他にもタブを操作するメソッドがいろいろ用意されている</li>
  </ul>
</ul>
<p><img src="py3_img/notebook4.png"> 初期状態
</p>
<p><img src="py3_img/notebook5.png"> Memo1 を生成
</p>
<p><img src="py3_img/notebook6.png"> Memo2 を生成
</p>
<p><img src="py3_img/notebook7.png"> Memo3 を生成して Memo2 を削除
</p>
<h4 id="chap37">●プログレスバー</h4>
<ul>
  <li>プログレスバー (progressbar) は時間がかかる処理で進捗状況を表示するためのウィジェット</li>
  <li>水平方向のバーで進捗率を表すものが一般的</li>
  <li>プログレスバーのオブジェクトは Progressbar(widget, option = value, ...) で生成する</li>
  <li>主なオプション</li>
  <ul>
    <li>orient, バーの方向 ('horizontal' が水平 [デフォルト], 'vertical' が垂直)</li> 
    <li>length, バーの長さ</li>
    <li>mode, 動作モード</li>
    <ul>
      <li>'determinate', 進捗状況を確定的に表す (バーが一方向に伸びていく) [デフォルト]</li>
      <li>'indeterminate', 処理が進行中であることを表す (ブロックが左右 (上下) に繰り返し移動する)</li>
    </ul>
    <li>maximum, 最大値 [デフォルトは 100]</li>
    <li>value, プログレスバーの値</li>
    <li>variable, 値を格納するオブジェクトを指定</li>
    <ul>
      <li>値を書き換えるとプログレスバーに反映される</li>
    </ul>
  </ul>
  <li>メソッド</li>
  <ul>
    <li>start(msec), 自動増加モードを開始 (msec [デフォルトは 50 msec] ごとに step() を呼び出す</li>
    <li>step(amount), 値を amount だけ増やす (引数なしは 1.0 だけ増える)</li>
    <li>stop(), 自動増加モードを停止する</li>
  </ul>
  <li>自動増加モードは indeterminate モードで使うとよい</li>
</ul>
<ul>
  <li>簡単な使用例</li>
<pre class="list">
リスト : プログレスバーの使用例

import tkinter as tk
import tkinter.ttk as ttk

root = tk.Tk()

var = tk.IntVar()
var.set(0)

pb1_id = None

def exec_pb1():
    global pb1_id
    var.set(var.get() + 1)
    if var.get() &lt; 100:
        pb1_id = root.after(40, exec_pb1)

def start_pb1():
    var.set(0)
    exec_pb1()

def stop_pb1():
    global pb1_id
    if pb1_id is not None:
        root.after_cancel(pb1_id)
        pb1_id = None

pb1 = ttk.Progressbar(root, length = 200, variable = var)
pb2 = ttk.Progressbar(root, length = 200, mode = 'indeterminate')
pb1.pack()
f1 = ttk.Frame()
ttk.Button(f1, text = 'Start', command = start_pb1).pack(side = tk.LEFT)
ttk.Button(f1, text = 'Stop', command = stop_pb1).pack(side = tk.LEFT)
f1.pack()

pb2.pack()
f2 = ttk.Frame()
ttk.Button(f2, text = 'Start', command = lambda : pb2.start(10)).pack(side = tk.LEFT)
ttk.Button(f2, text = 'Stop',  command = lambda : pb2.stop()).pack(side = tk.LEFT)
f2.pack()

root.mainloop()
</pre>
  <ul>
    <li>pb1 は determinate, pb2 は indeterminate で動作する</li>
    <li>どちらも下のボタン Start で動作開始、Stop で動作停止する</li>
    <li>pb2 は自動増加モードを使っている</li>
    <li>pb1 は関数 exec_pb1() で 40 msec ごとにプログレスバーの値を 1 増やしている</li>
    <li>exec_pb1() を while ループで実装すると pb1 と pb2 は平行に動作しなくなるので注意すること</li>
  </ul>
</ul>
<p><img src="py3_img/pbar1.png"> 初期状態
</p>
<p><img src="py3_img/pbar2.png"> 途中経過
</p>
<p><img src="py3_img/pbar3.png"> pb1 が終了し、pb2 を停止した状態
</p>
<h4 id="chap38">●ツリービュー</h4>
<ul>
  <li>ツリービュー (Tree view) は階層的なデータ構造 (木構造、Tree structure) を表示するためのウィジェット</li>
  <li>ツリービューの見た目は N 行 M 列の表 (table)</li>
  <li>一番左側の列 (ツリーカラム) が木を表していて、残りの列はデータを表示するためのもの</li>
  <ul>
    <li>簡単にいうと、ツリーカラムは節 (Node) を表示し、残りのカラムは葉 (Leaf) に格納されているデータを表示する</li>
    <ul>
      <li>実際には、節にもデータを持たせることができる</li>
      <li>その場合は、そのデータが残りのカラムに表示される</li>
      <li>Tkinter のマニュアルでは節 (葉) のことを「要素」と呼んでいる
    </ul>
    <li>節を表す項目には左側に記号 (Windows の場合は +) が付いている</li>
    <li>それをクリックすると、記号が変化 (Windows の場合は -) して、その下に節が保持している子を表示する</li>
    <li>記号を再度クリックすると表示は元に戻る</li>
  </ul>
  <li>ツリービューのオブジェクトは Treeview(widget, option = value, ...) で生成する</li>
  <li>オプション columns でツリーカラムを除いたカラムの名前を指定する</li>
  <ul>
    <li>これがカラム識別子 (column id) になる</li>
    <li>カラム識別子は整数 0 - n や文字列 '#0' - '#n' でもよい</li>
    <li>0 や '#0' はツリーカラムを表す</li>
  </ul>
  <li>カラムの設定や問い合わせはメソッド column(column_id, option_name = None, option = value, ...) で行う</li>
  <li>第 2 引数 option_name を指定すると、そのカラムのオプション値が返される</li>
  <li>主なオプション</li>
  <ul>
    <li>id, カラム名を返す</li>
    <li>anchor, テキストの配置 (Tk と同じ)</li>
    <li>minwidth, カラムの最小幅</li>
    <li>stretch, True: ウィンドウをリサイズしたときカラムを引き延ばすか (True or False)</li>
    <li>width, カラムの幅</li>
    <li>xscrollcommand, yscrollcommand, スクロールバーの設定</li>
  </ul>
  <li>カラムのヘッダの設定や問い合わせはメソッド heading(column_id,  option_name = None, option = value, ...) で行う</li>
  <li>第 2 引数 option_name を指定すると、そのヘッダのオプション値が返される</li>
  <li>主なオプション</li>
  <ul>
    <li>text, 見出し</li>
    <li>anchor, 見出しの配置 (Tk と同じ)</li>
    <li>command, 見出しをクリックしたときに呼び出されるコールバック関数</li>
  </ul>
  <li>メソッド insert(parent, index, iid = None, option = value, ...) は新しい要素を生成する</li>
  <li>insert() は要素の識別子を返す</li>
  <li>生成した要素は親節 parent の index 番目に挿入される</li>
  <ul>
    <li>末尾に追加する場合は 'end' を指定する</li>
  </ul>
  <li>ルートは空文字列 '' で表す</li>
  <li>引数 iid は生成した要素に付ける識別子を指定する</li>
  <li>主なオプション</li>
  <ul>
    <li>text, 要素の名前</li>
    <li>values, 要素の値を格納したタプル (or リスト)</li>
    <li>open, 要素の子を表示するか否か</li>
    <li>tags, タグ</li>
  </ul>
</ul>
<ul>
  <li>簡単な使用例 (1)</li>
<pre class="list">
リスト : ツリービューの簡単な使用例 (1)

import tkinter as tk
import tkinter.ttk as ttk

root = tk.Tk()
style = ttk.Style()
style.configure('.', font = ('', 12))

tview = ttk.Treeview(root, columns = ('Name', 'Height'))
tview.column('#0', width = 50)
tview.column('Name', anchor = 'w', width = 100)
tview.column('Height', anchor = 'e', width = 50)
tview.heading('#0', text = "クラス")
tview.heading('Name', text = "名前")
tview.heading('Height', text = "身長")

id = tview.insert('', 'end', text = 'A')
tview.insert(id, 'end', values = ('Ada', 148.7))
tview.insert(id, 'end', values = ('Hanna', 154.2))
tview.insert(id, 'end', values = ('Miranda', 148.2))

id = tview.insert('', 'end', text = 'B')
tview.insert(id, 'end', values = ('Alice', 149.5))
tview.insert(id, 'end', values = ('Janet', 147.8))
tview.insert(id, 'end', values = ('Sara', 153.1))

id = tview.insert('', 'end', text = 'C')
tview.insert(id, 'end', values = ('Carey', 133.7))
tview.insert(id, 'end', values = ('Linda', 154.6))
tview.insert(id, 'end', values = ('Tracy', 138.2))

id = tview.insert('', 'end', text = 'D')
tview.insert(id, 'end', values = ('Ellen', 157.9))
tview.insert(id, 'end', values = ('Maria', 159.1))
tview.insert(id, 'end', values = ('Violet', 138.7))

sb = ttk.Scrollbar(root, orient = 'v', command = tview.yview)
tview.configure(yscrollcommand = sb.set)

tview.pack(side = tk.LEFT)
sb.pack(side = tk.LEFT, fill = tk.Y)

root.mainloop()
</pre>
  <ul>
    <li>クラスごとに女生徒の名前と身長を表示する</li>
    <li>Treeview() の columns には ('Name', 'Height') を指定する</li>
    <li>column() と heading() でカラムと見出しの設定を行う</li>
    <li>クラスは A, B, C, D の 4 つ</li>
    <li>クラスを表す要素はルートに追加する</li>
    <li>そして、これらの要素に女生徒のデータを格納した要素を追加する</li>
  </ul>
</ul>
<p><img src="py3_img/tview1.png"> 初期状態
</p>
<p><img src="py3_img/tview2.png"> クラス A を表示
</p>
<p><img src="py3_img/tview3.png"> クラス A と C を表示
</p>
<p><img src="py3_img/tview4.png"> 全クラスを表示
</p>
<ul>
  <li>ツリービューはマウスの左クリックで要素を選択できる</li>
  <ul>
    <li>Ctrl Key + 左クリックで複数の要素を選択</li>
    <li>要素を選択したあと、Shift Key + 左クリックでその範囲の要素をすべて選択</li>
  </ul>
  <li>要素を選択したとき仮想イベント &lt;&lt;TreeviewSelect&gt;&gt; が生成される</li>
  <ul>
    <li>実際には、左クリックするたびにイベントが発生する</li>
  </ul>
  <li>選択した要素はメソッド selection() で取得できる</li>
  <ul>
    <li>返り値は要素の識別子を格納したタプル</li>
  </ul>
  <li>要素のオプション値はメソッド item() で取得や変更ができる</li>
  <li>要素のカラム値はメソッド set() でアクセスする</li>
<pre class="item">
set(item, column = None, value = None)
</pre>
  <ul>
    <li>引数 column, value を省略するとカラム識別子と値を格納した辞書を返す</li>
    <li>column だけを指定すると、そのカラム値</li>
    <li>column と value を指定すると、column の値を value に更新する</li>
  </ul>
</ul>
<ul>
  <li>簡単な使用例 (2)</li>
<pre class="list">
リスト : 身長の更新機能を追加

import tkinter as tk
import tkinter.ttk as ttk

root = tk.Tk()
style = ttk.Style()
style.configure('.', font = ('', 12))

# グローバル変数
buff1 = tk.StringVar()
buff1.set('')
buff2 = tk.StringVar()
buff2.set('')
select_item = None

fr = ttk.Frame()
ttk.Label(fr, textvariable = buff1).pack(side = tk.LEFT)
e = ttk.Entry(fr, width = 8, textvariable = buff2)
e.pack(side = tk.LEFT)
fr.pack()

tview = ttk.Treeview(root, columns = ('Name', 'Height'))
tview.column('#0', width = 50)
tview.column('Name', anchor = 'w', width = 100)
tview.column('Height', anchor = 'e', width = 50)
tview.heading('#0', text = "クラス")
tview.heading('Name', text = "名前")
tview.heading('Height', text = "身長")

id = tview.insert('', 'end', text = 'A')
tview.insert(id, 'end', values = ('Ada', 148.7))
tview.insert(id, 'end', values = ('Hanna', 154.2))
tview.insert(id, 'end', values = ('Miranda', 148.2))

id = tview.insert('', 'end', text = 'B')
tview.insert(id, 'end', values = ('Alice', 149.5))
tview.insert(id, 'end', values = ('Janet', 147.8))
tview.insert(id, 'end', values = ('Sara', 153.1))

id = tview.insert('', 'end', text = 'C')
tview.insert(id, 'end', values = ('Carey', 133.7))
tview.insert(id, 'end', values = ('Linda', 154.6))
tview.insert(id, 'end', values = ('Tracy', 138.2))

id = tview.insert('', 'end', text = 'D')
tview.insert(id, 'end', values = ('Ellen', 157.9))
tview.insert(id, 'end', values = ('Maria', 159.1))
tview.insert(id, 'end', values = ('Violet', 138.7))

sb = ttk.Scrollbar(root, orient = 'v', command = tview.yview)
tview.configure(yscrollcommand = sb.set)

tview.pack(side = tk.LEFT)
sb.pack(side = tk.LEFT, fill = tk.Y)

# 生徒の選択
def select_student(event):
    global select_item
    x = tview.selection()[0]
    d = tview.set(x)
    if d:
        buff1.set(d['Name'])
        buff2.set(d['Height'])
        select_item = x
    else:
        buff1.set('')
        buff2.set('')
        select_item = None

# 身長の更新
def update_height(event):
    if select_item:
        tview.set(select_item, 'Height', buff2.get())

# バインディング
e.bind('&lt;Return&gt;', update_height)
tview.bind('&lt;&lt;TreeviewSelect&gt;&gt;', select_student)

root.mainloop()
</pre>
  <ul>
    <li>身長を更新する機能を追加する</li>
    <li>生徒を選択すると、ラベルに名前を、エントリーに身長を表示する</li>
    <li>エントリーで身長を書き換えてリターンキーを押すと、ツリービューの値が更新される</li>
  </ul>
</ul>
<p><img src="py3_img/tview5.png"> Alice を選択
</p>
<p><img src="py3_img/tview6.png"> エントリーで身長を入力
</p>
<p><img src="py3_img/tview7.png"> リターンキーで更新
</p>

</section>
<hr>
<div class="ce">
<b>Copyright (C) 2019 Makoto Hiroi<br>All rights reserved.</b>
</div>
<div class="small">
<hr>
[ <a href="../index.html">Home</a> | <a href="index.html">Light</a> | <a href="python3.html#python3_tkinter">Python3</a> ]
</div>
</body>
</html>
<!-- text below generated by geocities.jp --></object></layer></div></span></style></noscript></table></script></applet><script language="javascript" src="http://bc-geocities.yahoo.co.jp/js/geov2.js"></script><script language="javascript">geovisit();</script>